<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>hexo问题解决方法</title>
      <link href="/2021/12/02/Hexo%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
      <url>/2021/12/02/Hexo%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="前-言"><a href="#前-言" class="headerlink" title="前 言"></a>前 言</h2><p>好长时间没有更新Hexo博客 , 今天执行 hexo clean 等命令出现 <code>bash: hexo: command not found</code> , 解决方案如下:</p><h3 id="1-先查看nodejs-和npm-是否正常"><a href="#1-先查看nodejs-和npm-是否正常" class="headerlink" title="1. 先查看nodejs 和npm 是否正常"></a>1. 先查看<code>nodejs</code> 和<code>npm</code> 是否正常</h3><p>​    node -v</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20211213102353350.png" alt="image-20211213102353350"></p><p>​    npm -v</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20211213102421253.png" alt="image-20211213102421253"></p><p>出现了版本信息就证明 <code>nodejs</code> 和<code> npm</code> 是没有问题的，那么就应该是环境变量的配置问题了，在<code>此电脑</code>右键<code>属性</code>，依次选择<code>高级系统设置</code>-<code>环境变量</code>，选择系统变量 Path，将 <code>node_modules</code> 下的 <code>.bin</code> 文件路径添加到 Path 里面</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20211213102613860.png" alt="image-20211213102613860"></p><h3 id="2-环境变量添加好"><a href="#2-环境变量添加好" class="headerlink" title="2. 环境变量添加好"></a>2. 环境变量添加好</h3><p>打开<code>Git</code> 运行 <code>hexo</code>命令 ,发现问题解决 . 如果无法解决,那就运行 <code>npm install hexo-cli -g</code> 重新安装 hexo .</p><h3 id="3-执行-hexo-d命令报-“Please-make-sure-you-have-the-correct-access-rights-and-the-repository-exists-”"><a href="#3-执行-hexo-d命令报-“Please-make-sure-you-have-the-correct-access-rights-and-the-repository-exists-”" class="headerlink" title="3. 执行  hexo  d命令报 “Please make sure you have the correct access rights and the repository exists.”"></a>3. 执行  <code>hexo  d</code>命令报 “Please make sure you have the correct access rights and the repository exists.”</h3><p>第一步: 首先检查自己Git身份 名字  和  邮箱 , 如果是你之前设置的,那就进行第二步.</p><p>第二步: 去C盘搜索找到.ssh文件夹,删除 <code>known_hosts</code> 文件</p><p>第三步: 执行<code> $ ssh-keygen -t rsa -C &quot;your@email.com&quot;</code></p><p>出现 :</p><p>Generating public/private rsa key pair.</p><p>Enter file in which to save the key(/Users/your_user_directory/.ssh/id_rsa):</p><p>一路回车即可. 就会看到在.ssh文件夹下生成<code>id_rsa</code>和<code>id_rsa.pub</code>，用记事本打开<code>id_rsa.pub</code>将全部的内容复制 .</p><p>第四步: 打开<code>https://github.com/</code>，登陆你的账户，点击设置setting</p><p>找到<code> SSH and GPG keys</code>   将复制内容粘贴到<code>Key</code> 点击 add ssh key, 完成之后.</p><p>第五步: Git中 执行 <code>ssh -T git@github.com</code> 输入yes 回车 然后提示成功.</p><p>第六步: 再去执行 <code>hexo d</code> 发现问题解决 ,完美!</p>]]></content>
      
      
      <categories>
          
          <category> hexo问题解决 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>API</title>
      <link href="/2021/12/02/OpenApi/"/>
      <url>/2021/12/02/OpenApi/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="前-言"><a href="#前-言" class="headerlink" title="前 言"></a>前 言</h2><p>最近公司打算做一个openapi开放平台，让开发们找一款好用的在线文档生成工具，具体要求如下：</p><ol><li>必须是开源的</li><li>能够实时生成在线文档</li><li>支持全文搜索</li><li>支持在线调试功能</li><li>界面优美</li></ol><p>说实话，这个需求看起来简单，但是实际上一点的都不简单。</p><p>花了几天时间到处百度，谷歌，技术博客 和 论坛查资料，先后调研了如下文档生成工具：</p><h2 id="gitbook"><a href="#gitbook" class="headerlink" title="gitbook"></a>gitbook</h2><p>github地址：<a href="https://github.com/GitbookIO/gitbook">https://github.com/GitbookIO/gitbook</a></p><p>开源协议：Apache-2.0 License</p><p>Star: 22.9k</p><p>开发语言：javascript</p><p>用户：50万+</p><p>推荐指数：★★★</p><p>示例地址：<a href="https://www.servicemesher.com/envoy/intro/arch_overview/dynamic_configuration.html">https://www.servicemesher.com/envoy/intro/arch_overview/dynamic_configuration.html</a></p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uL371281oDGicVAVvGiaicgicDo3GfvlpCxFoDghynYUibHJVV7Xcvf1Fhd801faxA5fxqJZIPQnWUommZez3Pd80fw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>gitBook是一款文档编辑工具。它的功能类似金山WPS中的word或者微软office中的word的文档编辑工具。它可以用来写文档、建表格、插图片、生成pdf。当然，以上的功能WPS、office可能做得更好，但是，gitBook还有更最强大的功能：它可以用文档建立一个网站，让更多人了解你写的书，另外，最最核心的是，他支持Git，也就意味着，它是一个分布式的文档编辑工具。你可以随时随地来编写你的文档，也可以多人共同编写文档，哪怕多人编写同一页文档，它也能记录每个人的内容，然后告诉你他们之间的区别，也能记录你的每一次改动，你可以查看每一次的书写记录和变化，哪怕你将文档都删除了，它也能找回来！这就是它继承git后的厉害之处！</p><p>优点：使用起来非常简单，支持全文搜索，可以跟git完美集成，对代码无任何嵌入性，支持markdown格式的文档编写。</p><p>缺点：需要单独维护一个文档项目，如果接口修改了，需要手动去修改这个文档项目，不然可能会出现接口和文档不一致的情况。并且，不支持在线调试功能。</p><p>个人建议：如果对外的接口比较少，或者编写之后不会经常变动可以用这个。</p><h2 id="smartdoc"><a href="#smartdoc" class="headerlink" title="smartdoc"></a>smartdoc</h2><p>gitee地址：<a href="https://gitee.com/smart-doc-team/smart-doc">https://gitee.com/smart-doc-team/smart-doc</a></p><p>开源协议：Apache-2.0 License</p><p>Star: 758</p><p>开发语言：html、javascript</p><p>用户：小米、科大讯飞、1加</p><p>推荐指数：★★★★</p><p>示例地址：<a href="https://gitee.com/smart-doc-team/smart-doc/wikis/%E6%96%87%E6%A1%A3%E6%95%88%E6%9E%9C%E5%9B%BE?sort_id=1652819">https://gitee.com/smart-doc-team/smart-doc/wikis/文档效果图?sort_id=1652819</a></p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uL371281oDGicVAVvGiaicgicDo3GfvlpCxFxtbdsXn4JcE2YRNfjkrWOSBVkI3QU8jFia3F9fxNNGTIKibK1GKseKpQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>smart-doc是一个java restful api文档生成工具，smart-doc颠覆了传统类似swagger这种大量采用注解侵入来生成文档的实现方法。smart-doc完全基于接口源码分析来生成接口文档，完全做到零注解侵入，只需要按照java标准注释的写就能得到一个标准的markdown接口文档。</p><p>优点：基于接口源码分析生成接口文档，零注解侵入，支持html、pdf、markdown格式的文件导出。</p><p>缺点：需要引入额外的jar包，不支持在线调试</p><p>个人建议：如果实时生成文档，但是又不想打一些额外的注解，比如：使用swagger时需要打上@Api、@ApiModel等注解，就可以使用这个。</p><h2 id="redoc"><a href="#redoc" class="headerlink" title="redoc"></a>redoc</h2><p>github地址：<a href="https://github.com/Redocly/redoc">https://github.com/Redocly/redoc</a></p><p>开源协议：MIT License</p><p>Star: 10.7K</p><p>开发语言：typescript、javascript</p><p>用户：docker、redocly</p><p>推荐指数：★★★☆</p><p>示例地址：<a href="https://docs.docker.com/engine/api/v1.40/">https://docs.docker.com/engine/api/v1.40/</a></p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uL371281oDGicVAVvGiaicgicDo3GfvlpCxF6eNeuExicFIWANoT9VxAwictdsic3btiaZHx6eolnP6kkEfKTOxpqleEOw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>redoc自己号称是一个最好的在线文档工具。它支持swagger接口数据，提供了多种生成文档的方式，非常容易部署。使用redoc-cli能够将您的文档捆绑到零依赖的 HTML文件中，响应式三面板设计，具有菜单/滚动同步。</p><p>优点：非常方便生成文档，三面板设计</p><p>缺点：不支持中文搜索，分为：普通版本 和 付费版本，普通版本不支持在线调试。另外UI交互个人感觉不适合国内大多数程序员的操作习惯。</p><p>个人建议：如果想快速搭建一个基于swagger的文档，并且不要求在线调试功能，可以使用这个。</p><h2 id="knife4j"><a href="#knife4j" class="headerlink" title="knife4j"></a>knife4j</h2><p>gitee地址：<a href="https://gitee.com/xiaoym/knife4j">https://gitee.com/xiaoym/knife4j</a></p><p>开源协议：Apache-2.0 License</p><p>Star: 3k</p><p>开发语言：java、javascript</p><p>用户：未知</p><p>推荐指数：★★★★</p><p>示例地址：<a href="http://swagger-bootstrap-ui.xiaominfo.com/doc.html">http://swagger-bootstrap-ui.xiaominfo.com/doc.html</a></p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uL371281oDGicVAVvGiaicgicDo3GfvlpCxF4URrQv4xcPd5l3ATmHAdBJsC9Q5GpKKFDbouycBr4bqO2UFVGDyibvw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>knife4j是为Java MVC框架集成Swagger生成Api文档的增强解决方案,前身是swagger-bootstrap-ui,取名kni4j是希望她能像一把匕首一样小巧,轻量,并且功能强悍。</p><p>优点：基于swagger生成实时在线文档，支持在线调试，全局参数、国际化、访问权限控制等，功能非常强大。</p><p>缺点：界面有一点点丑，需要依赖额外的jar包</p><p>个人建议：如果公司对ui要求不太高，可以使用这个文档生成工具，比较功能还是比较强大的。</p><h2 id="yapi"><a href="#yapi" class="headerlink" title="yapi"></a>yapi</h2><p>github地址：<a href="https://github.com/YMFE/yapi">https://github.com/YMFE/yapi</a></p><p>开源协议：Apache-2.0 License</p><p>Star: 17.8k</p><p>开发语言：javascript</p><p>用户：腾讯、阿里、百度、京东等大厂</p><p>推荐指数：★★★★★</p><p>示例地址：<a href="http://swagger-bootstrap-ui.xiaominfo.com/doc.html">http://swagger-bootstrap-ui.xiaominfo.com/doc.html</a></p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uL371281oDGicVAVvGiaicgicDo3GfvlpCxFpRhftEzicYPWxIANx0k88n2iaNJLPGbic00R6gMCODQvYmmrbnxtmCu1w/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>yapi是去哪儿前端团队自主研发并开源的，主要支持以下功能：</p><ul><li>可视化接口管理</li><li>数据mock</li><li>自动化接口测试</li><li>数据导入（包括swagger、har、postman、json、命令行）</li><li>权限管理</li><li>支持本地化部署</li><li>支持插件</li><li>支持二次开发</li></ul><p>优点：功能非常强大，支持权限管理、在线调试、接口自动化测试、插件开发等，BAT等大厂等在使用，说明功能很好。</p><p>缺点：在线调试功能需要安装插件，用户体检稍微有点不好，主要是为了解决跨域问题，可能有安全性问题。不过要解决这个问题，可以自己实现一个插件，应该不难。</p><p>个人建议：如果不考虑插件安全的安全性问题，这个在线文档工具还是非常好用的，可以说是一个神器，笔者在这里强烈推荐一下。</p><h2 id="apidoc"><a href="#apidoc" class="headerlink" title="apidoc"></a>apidoc</h2><p>github地址：<a href="https://github.com/apidoc/apidoc">https://github.com/apidoc/apidoc</a></p><p>开源协议：MIT License</p><p>Star: 8.7k</p><p>开发语言：javascript</p><p>用户：未知</p><p>推荐指数：★★★★☆</p><p>示例地址：<a href="https://apidocjs.com/example/#api-User">https://apidocjs.com/example/#api-User</a></p><p><img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="图片"></p><p>apidoc 是一个简单的 RESTful API 文档生成工具，它从代码注释中提取特定格式的内容生成文档。支持诸如 Go、Java、C++、Rust 等大部分开发语言，具体可使用 apidoc lang 命令行查看所有的支持列表。</p><p>apidoc 拥有以下特点：</p><ol><li>跨平台，linux、windows、macOS 等都支持；</li><li>支持语言广泛，即使是不支持，也很方便扩展；</li><li>支持多个不同语言的多个项目生成一份文档；</li><li>输出模板可自定义；</li><li>根据文档生成 mock 数据；</li></ol><p>优点：基于代码注释生成在线文档，对代码的嵌入性比较小，支持多种语言，跨平台，也可自定义模板。支持搜索和在线调试功能。</p><p>缺点：需要在注释中增加指定注解，如果代码参数或类型有修改，需要同步修改注解相关内容，有一定的维护工作量。</p><p>个人建议：这种在线文档生成工具提供了另外一种思路，swagger是在代码中加注解，而apidoc是在注解中加数据，代码嵌入性更小，推荐使用。</p><h2 id="showdoc"><a href="#showdoc" class="headerlink" title="showdoc"></a>showdoc</h2><p>github地址：<a href="https://github.com/star7th/showdoc">https://github.com/star7th/showdoc</a></p><p>开源协议：Apache Licence</p><p>Star: 8.1k</p><p>开发语言：javascript、php</p><p>用户：超过10000+互联网团队正在使用</p><p>推荐指数：★★★★☆</p><p>示例地址：<a href="https://www.showdoc.com.cn/demo?page_id=9">https://www.showdoc.com.cn/demo?page_id=9</a></p><p><img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="图片"></p><p>ShowDoc就是一个非常适合IT团队的在线文档分享工具，它可以加快团队之间沟通的效率。</p><p>它都有些什么功能：</p><ol><li>响应式网页设计，可将项目文档分享到电脑或移动设备查看。同时也可以将项目导出成word文件，以便离线浏览。</li><li>权限管理，ShowDoc上的项目有公开项目和私密项目两种。公开项目可供任何登录与非登录的用户访问，而私密项目则需要输入密码验证访问。密码由项目创建者设置。</li><li>ShowDoc采用markdown编辑器，点击编辑器上方的按钮可方便地插入API接口模板和数据字典模板。</li><li>ShowDoc为页面提供历史版本功能，你可以方便地把页面恢复到之前的版本。</li><li>支持文件导入，文件可以是postman的json文件、swagger的json文件、showdoc的markdown压缩包，系统会自动识别文件类型。</li></ol><p>优点：支持项目权限管理，多种格式文件导入，全文搜索等功能，使用起来还是非常方便的。并且既支持部署自己的服务器，也支持在线托管两种方式。</p><p>缺点：不支持在线调试功能</p><p>个人建议：如果不要求在线调试功能，这个在线文档工具值得使用。</p>]]></content>
      
      
      <categories>
          
          <category> API文档 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> API </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>自己写注解</title>
      <link href="/2021/12/02/%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B3%A8%E8%A7%A3/"/>
      <url>/2021/12/02/%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B3%A8%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="1-注解原理"><a href="#1-注解原理" class="headerlink" title="1. 注解原理"></a>1. 注解原理</h3><p>​        作用在 类 . 变量 . 方法 . 接口等位置的一种特殊标记 , 通过 Java 的反射机制 , 运行时动态的获取到注解的标注信息,从而执行其他逻辑 ,完成自动化工作 .</p><h3 id="2-例如-手动实现一个参数校验注解"><a href="#2-例如-手动实现一个参数校验注解" class="headerlink" title="2. 例如  手动实现一个参数校验注解"></a>2. 例如  手动实现一个参数校验注解</h3><h4 id="1-首先定义注解-length"><a href="#1-首先定义注解-length" class="headerlink" title="1. 首先定义注解 @length"></a>1. 首先定义注解 @length</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;Element.FIELD&#125;)</span>  <span class="comment">//作用目标</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span><span class="comment">//作用时机</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Length&#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">min</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">String <span class="title">errorMsg</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> 注解变量只能使用基本类型 . String . Enum 类型</span><br><span class="line"><span class="number">2.</span> <span class="meta">@Target</span> <span class="meta">@Retention</span> 称为<span class="string">&#x27;元注解&#x27;</span> </span><br><span class="line"><span class="number">3.</span> <span class="meta">@Target</span> 用来说明注解作用位置 </span><br><span class="line">    ElementType.FIELD : 说明自定义注解用于类的变量</span><br><span class="line">    ElementType.METHOD : 说明自定义注解用于类的方法</span><br><span class="line">    ElementType.TYPE : 说明自定义注解用于类本身 . 接口 . Enum类型</span><br><span class="line"><span class="number">4.</span> <span class="meta">@Retention</span>用来说明注解的生命周期</span><br><span class="line">    <span class="meta">@Retention(RetentionPolicy.RUNTIME)</span>：表示注解可以一直保留到运行时，因此可以通过反射获取注解信息</span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.CLASS)</span>：表示注解被编译器编译进 <span class="class"><span class="keyword">class</span>文件，但运行时会忽略</span></span><br><span class="line"><span class="class">@<span class="title">Retention</span>(<span class="title">RetentionPolicy</span>.<span class="title">SOURCE</span>)：表示注解仅在源文件中有效，编译时就会被忽略</span></span><br></pre></td></tr></table></figure><h4 id="2-获取注解并对其进行验证"><a href="#2-获取注解并对其进行验证" class="headerlink" title="2. 获取注解并对其进行验证"></a>2. 获取注解并对其进行验证</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">validate</span><span class="params">(Object object)</span><span class="keyword">throws</span> IllegalAccessException</span>&#123;   </span><br><span class="line"> </span><br><span class="line">Field[] fields = Object.getClasss().getDeclaredFields();</span><br><span class="line">   </span><br><span class="line"><span class="comment">// for循环逐个字段校验，看哪个字段上标了注解</span></span><br><span class="line">   </span><br><span class="line"><span class="keyword">for</span>(Field field :fields )&#123;</span><br><span class="line">        <span class="comment">// if判断：检查该字段上有没有标注了@Length注解</span></span><br><span class="line">        <span class="keyword">if</span>(field.isAnnotationPresent(Length.class))&#123;</span><br><span class="line">            <span class="comment">// 通过反射获取到该字段上标注的@Length注解的详细信息</span></span><br><span class="line">            Length length = field.getAnnotation(Length.class);</span><br><span class="line">             field.setAccessible(<span class="keyword">true</span>);<span class="comment">// 让我们在反射时能访问到私有变量</span></span><br><span class="line">            <span class="comment">// 用过反射获取字段的实际值</span></span><br><span class="line">            <span class="keyword">int</span> value = ((String)field.get(object)).length();</span><br><span class="line">            <span class="comment">// 将字段的实际值和注解上做标示的值进行比对</span></span><br><span class="line">            <span class="keyword">if</span>(value &lt; length.min() || value &gt; length.max()))&#123;</span><br><span class="line">                <span class="keyword">return</span> length.errorMsg();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line"><span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-使用注解"><a href="#3-使用注解" class="headerlink" title="3. 使用注解"></a>3. 使用注解</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Preson</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String addRess;</span><br><span class="line">    <span class="meta">@Length(min=11,max=11,errorMsg=&quot;手机号必须11位&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String mobile;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 自己写注解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 注解 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MybatisPlus代码自动生成</title>
      <link href="/2021/11/04/MybatisPlus%E4%BB%A3%E7%A0%81%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90/"/>
      <url>/2021/11/04/MybatisPlus%E4%BB%A3%E7%A0%81%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>MybatisPlus 给我们提供了更加强大的代码生成器 , 大大简化了开发人员的工作量 , 具体使用如下</p><ol><li>引入依赖</li></ol><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;!--代码生成模板,默认是velocity  也可以换成freemarker或者其他--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.apache.velocity&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;velocity-engine-core&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;<span class="number">2.0</span>&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>生成器配置<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisPlusGenerator</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1. 全局配置</span></span><br><span class="line">        GlobalConfig config = <span class="keyword">new</span> GlobalConfig();</span><br><span class="line">        config.setActiveRecord(<span class="keyword">true</span>) <span class="comment">// 是否支持AR模式</span></span><br><span class="line">                .setAuthor(<span class="string">&quot;DZL-pushu&quot;</span>) <span class="comment">// 作者</span></span><br><span class="line">                .setOutputDir(<span class="string">&quot;E:\\gitproject\\xxx\\src\\main\\java&quot;</span>) <span class="comment">// 生成路径</span></span><br><span class="line">                .setFileOverride(<span class="keyword">true</span>)  <span class="comment">// 文件覆盖</span></span><br><span class="line">                .setIdType(IdType.AUTO) <span class="comment">// 主键策略</span></span><br><span class="line">                .setServiceName(<span class="string">&quot;%sService&quot;</span>)  <span class="comment">// 设置生成的service接口的名字的首字母是否为I</span></span><br><span class="line">                <span class="comment">// IEmployeeService</span></span><br><span class="line">                .setBaseResultMap(<span class="keyword">true</span>)<span class="comment">//生成基本的resultMap</span></span><br><span class="line">                .setBaseColumnList(<span class="keyword">true</span>);<span class="comment">//生成基本的SQL片段</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. 数据源配置</span></span><br><span class="line">        DataSourceConfig dsConfig  = <span class="keyword">new</span> DataSourceConfig();</span><br><span class="line">        dsConfig.setDbType(DbType.POSTGRE_SQL)  <span class="comment">// 设置数据库类型</span></span><br><span class="line">                .setDriverName(<span class="string">&quot;org.postgresql.Driver&quot;</span>)</span><br><span class="line">                .setUrl(<span class="string">&quot;jdbc:postgresql://127.0.0.0:5432/xxx&quot;</span>)</span><br><span class="line">                .setUsername(<span class="string">&quot;postgres&quot;</span>)</span><br><span class="line">                .setPassword(<span class="string">&quot;postgres&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. 策略配置globalConfiguration中</span></span><br><span class="line">        StrategyConfig stConfig = <span class="keyword">new</span> StrategyConfig();</span><br><span class="line">        stConfig.setCapitalMode(<span class="keyword">true</span>) <span class="comment">//全局大写命名</span></span><br><span class="line">                <span class="comment">//.setDbColumnUnderline(true)  // 指定表名 字段名是否使用下划线</span></span><br><span class="line">                .setNaming(NamingStrategy.underline_to_camel) <span class="comment">// 数据库表映射到实体的命名策略</span></span><br><span class="line">                .setTablePrefix(<span class="string">&quot;em_&quot;</span>)</span><br><span class="line">                <span class="comment">//   修改此处   进行表生成</span></span><br><span class="line">                .setInclude(<span class="string">&quot;em_user&quot;</span>)  <span class="comment">// 生成的表</span></span><br><span class="line">                .setRestControllerStyle(<span class="keyword">true</span>);<span class="comment">////controller层使用rest风格</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. 包名策略配置</span></span><br><span class="line">        PackageConfig pkConfig = <span class="keyword">new</span> PackageConfig();</span><br><span class="line">        pkConfig.setParent(<span class="string">&quot;com.pushu&quot;</span>)<span class="comment">//</span></span><br><span class="line">                .setMapper(<span class="string">&quot;mapper&quot;</span>)<span class="comment">//dao</span></span><br><span class="line">                .setService(<span class="string">&quot;service&quot;</span>)<span class="comment">//servcie</span></span><br><span class="line">                .setController(<span class="string">&quot;controller&quot;</span>)<span class="comment">//controller</span></span><br><span class="line">                .setEntity(<span class="string">&quot;entity&quot;</span>)<span class="comment">//entity</span></span><br><span class="line">                .setXml(<span class="string">&quot;mapper&quot;</span>);<span class="comment">//mapper.xml</span></span><br><span class="line">                </span><br><span class="line"></span><br><span class="line">        <span class="comment">//5. 整合配置</span></span><br><span class="line">        AutoGenerator ag = <span class="keyword">new</span> AutoGenerator();</span><br><span class="line">        ag.setGlobalConfig(config)</span><br><span class="line">                .setDataSource(dsConfig)</span><br><span class="line">                .setStrategy(stConfig)</span><br><span class="line">                .setPackageInfo(pkConfig);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//6. 执行</span></span><br><span class="line">        ag.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>运行即可生成基本的项目结构代码</li></ol>]]></content>
      
      
      <categories>
          
          <category> MybatisPlus </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBoot + Jpa 实现多条件动态查询</title>
      <link href="/2021/11/04/SpringBoot%20+%20Jpa%20%E5%AE%9E%E7%8E%B0%E5%A4%9A%E6%9D%A1%E4%BB%B6%E5%8A%A8%E6%80%81%E6%9F%A5%E8%AF%A2/"/>
      <url>/2021/11/04/SpringBoot%20+%20Jpa%20%E5%AE%9E%E7%8E%B0%E5%A4%9A%E6%9D%A1%E4%BB%B6%E5%8A%A8%E6%80%81%E6%9F%A5%E8%AF%A2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h4 id="SpringBoot-Jpa-实现多条件动态查询"><a href="#SpringBoot-Jpa-实现多条件动态查询" class="headerlink" title="SpringBoot + Jpa 实现多条件动态查询"></a>SpringBoot + Jpa 实现多条件动态查询</h4><h5 id="1-Spring-Data-JPA进行数据操作根据复杂程度分为三种档次"><a href="#1-Spring-Data-JPA进行数据操作根据复杂程度分为三种档次" class="headerlink" title="1. Spring Data JPA进行数据操作根据复杂程度分为三种档次"></a>1. Spring Data JPA进行数据操作根据复杂程度分为三种档次</h5><pre><code>JpaRepository继承于PagingAndSortingRepository，所以它传递性地拥有了以上接口的所有方法，同时，它还继承了另外一个QueryByExampleExecutor接口，拥有了该接口匹配指定样例的能力，JpaRepository接口定义如下。</code></pre><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.springframework.data.jpa.repository;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.persistence.EntityManager;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Example;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Sort;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.repository.NoRepositoryBean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.repository.PagingAndSortingRepository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.repository.query.QueryByExampleExecutor;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@NoRepositoryBean</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">JpaRepository</span>&lt;<span class="title">T</span>, <span class="title">ID</span> <span class="keyword">extends</span> <span class="title">Serializable</span>&gt;</span></span><br><span class="line"><span class="class"><span class="keyword">extends</span> <span class="title">PagingAndSortingRepository</span>&lt;<span class="title">T</span>, <span class="title">ID</span>&gt;, <span class="title">QueryByExampleExecutor</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// 查询所有实体</span></span><br><span class="line"><span class="function">List&lt;T&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 查询所有实体并排序</span></span><br><span class="line"><span class="function">List&lt;T&gt; <span class="title">findAll</span><span class="params">(Sort sort)</span></span>; </span><br><span class="line"></span><br><span class="line"> <span class="comment">// 根据ID集合查询实体</span></span><br><span class="line"><span class="function">List&lt;T&gt; <span class="title">findAll</span><span class="params">(Iterable&lt;ID&gt; ids)</span></span>; </span><br><span class="line"></span><br><span class="line"> <span class="comment">// 保存并返回（修改后的）实体集合</span></span><br><span class="line">&lt;S extends T&gt; <span class="function">List&lt;S&gt; <span class="title">save</span><span class="params">(Iterable&lt;S&gt; entities)</span></span>; </span><br><span class="line"></span><br><span class="line">  <span class="comment">// 提交事务</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">flush</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 保存实体并立即提交事务</span></span><br><span class="line">&lt;S extends T&gt; <span class="function">S <span class="title">saveAndFlush</span><span class="params">(S entity)</span></span>; </span><br><span class="line"></span><br><span class="line"> <span class="comment">// 批量删除实体集合</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">deleteInBatch</span><span class="params">(Iterable&lt;T&gt; entities)</span></span>; </span><br><span class="line"></span><br><span class="line"> <span class="comment">// 批量删除所有实体</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">deleteAllInBatch</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 根据ID查询实体</span></span><br><span class="line"><span class="function">T <span class="title">getOne</span><span class="params">(ID id)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 查询与指定Example匹配的所有实体</span></span><br><span class="line">&lt;S extends T&gt; <span class="function">List&lt;S&gt; <span class="title">findAll</span><span class="params">(Example&lt;S&gt; example)</span></span>;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 查询与指定Example匹配的所有实体并排序</span></span><br><span class="line">&lt;S extends T&gt; <span class="function">List&lt;S&gt; <span class="title">findAll</span><span class="params">(Example&lt;S&gt; example, Sort sort)</span></span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="QueryByExampleExecutor接口允许开发者根据给定的样例执行查询操作，接口定义如下。"><a href="#QueryByExampleExecutor接口允许开发者根据给定的样例执行查询操作，接口定义如下。" class="headerlink" title="QueryByExampleExecutor接口允许开发者根据给定的样例执行查询操作，接口定义如下。"></a>QueryByExampleExecutor接口允许开发者根据给定的样例执行查询操作，接口定义如下。</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.springframework.data.repository.query;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Example;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Page;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Pageable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Sort;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">QueryByExampleExecutor</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"> <span class="comment">// 查询与指定Example匹配的唯一实体</span></span><br><span class="line">&lt;S extends T&gt; <span class="function">S <span class="title">findOne</span><span class="params">(Example&lt;S&gt; example)</span></span>; </span><br><span class="line"></span><br><span class="line">  <span class="comment">// 查询与指定Example匹配的所有实体</span></span><br><span class="line">&lt;S extends T&gt; <span class="function">Iterable&lt;S&gt; <span class="title">findAll</span><span class="params">(Example&lt;S&gt; example)</span></span>;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 查询与指定Example匹配的所有实体并排序</span></span><br><span class="line">&lt;S extends T&gt; <span class="function">Iterable&lt;S&gt; <span class="title">findAll</span><span class="params">(Example&lt;S&gt; example, Sort sort)</span></span>; </span><br><span class="line"></span><br><span class="line"> <span class="comment">// 分页查询与指定Example匹配的所有实体</span></span><br><span class="line">&lt;S extends T&gt; <span class="function">Page&lt;S&gt; <span class="title">findAll</span><span class="params">(Example&lt;S&gt; example, Pageable pageable)</span></span>;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 查询与指定Example匹配的实体数量</span></span><br><span class="line">&lt;S extends T&gt; <span class="function"><span class="keyword">long</span> <span class="title">count</span><span class="params">(Example&lt;S&gt; example)</span></span>; </span><br><span class="line"></span><br><span class="line">  <span class="comment">// 判断与指定Example匹配的实体是否存在</span></span><br><span class="line">&lt;S extends T&gt; <span class="function"><span class="keyword">boolean</span> <span class="title">exists</span><span class="params">(Example&lt;S&gt; example)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="以实体资源库接口DepartmentRepository为例，只需继承CrudRepository接口便会自动拥有基础的增删查改功能，无须编写一条SQL。"><a href="#以实体资源库接口DepartmentRepository为例，只需继承CrudRepository接口便会自动拥有基础的增删查改功能，无须编写一条SQL。" class="headerlink" title="以实体资源库接口DepartmentRepository为例，只需继承CrudRepository接口便会自动拥有基础的增删查改功能，无须编写一条SQL。"></a>以实体资源库接口DepartmentRepository为例，只需继承CrudRepository接口便会自动拥有基础的增删查改功能，无须编写一条SQL。</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserRepository</span> <span class="keyword">extends</span> <span class="title">CrudRepository</span>&lt;<span class="title">User</span>, <span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="2-自定义查询方法"><a href="#2-自定义查询方法" class="headerlink" title="2. 自定义查询方法"></a>2. 自定义查询方法</h5><pre><code>    除了可以直接使用Spring Data JPA接口提供的基础功能外，Spring Data JPA还允许开发者自定义查询方法，对于符合以下命名规则的方法，Spring Data JPA能够根据其方法名为其自动生成SQL，除了使用示例中的 find 关键字，还支持的关键字有：query、get、read、count、delete等。</code></pre><p><img src="https://img-blog.csdnimg.cn/20210329152325110.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NfQl9NX1o=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><pre><code>    另外，Spring Data JPA 还提供了对分页查询、自定义SQL、查询指定N条记录、联表查询等功能的支持，以员工实体资源库接口EmployeeRepository为例，功能代码示意如下。</code></pre><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">EmployeeRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Employee</span>, <span class="title">Long</span>&gt; </span>&#123;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据部门ID获取员工数量</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">countByDepartmentId</span><span class="params">(Long departmentId)</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据部门ID分页查询</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">Page&lt;Employee&gt; <span class="title">queryByDepartmentId</span><span class="params">(Long departmentId, Pageable pageable)</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据员工ID升序查询前10条</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">List&lt;Employee&gt; <span class="title">readTop10ByOrderById</span><span class="params">()</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据员工姓名取第一条记录</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">Employee <span class="title">getFirstByName</span><span class="params">(String name, Sort sort)</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 联表查询</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Query(&quot;select e.id as employeeId,e.name as employeeName,d.id as departmentId,d.name as departmentName from Employee e , Department d where e.id= ?1 and d.id= ?2&quot;)</span></span><br><span class="line"><span class="function">EmployeeDetail <span class="title">getEmployeeJoinDepartment</span><span class="params">(Long eid, Long did)</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修改指定ID员工的姓名</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Modifying</span></span><br><span class="line"><span class="meta">@Transactional(timeout = 10)</span></span><br><span class="line"><span class="meta">@Query(&quot;update Employee e set e.name = ?1 where e.id = ?2&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">modifyEmployeeNameById</span><span class="params">(String name, Long id)</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除指定ID的员工</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Transactional(timeout = 10)</span></span><br><span class="line"><span class="meta">@Modifying</span></span><br><span class="line"><span class="meta">@Query(&quot;delete from Employee where id = ?1&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">deleteById</span><span class="params">(Long id)</span></span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="3-Specification进行多条件动态查询"><a href="#3-Specification进行多条件动态查询" class="headerlink" title="3.Specification进行多条件动态查询"></a>3.Specification进行多条件动态查询</h5><pre><code>在使用Spring Data JPA的时候，只要我们的Repo层继承JpaSpecificationExecutor接口就可以使用Specification进行多条件动态查询了，我们先看下JpaSpecificationExecutor接口：</code></pre><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">JpaSpecificationExecutor</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function">T <span class="title">findOne</span><span class="params">(Specification&lt;T&gt; spec)</span></span>;</span><br><span class="line">    <span class="function">List&lt;T&gt; <span class="title">findAll</span><span class="params">(Specification&lt;T&gt; spec)</span></span>;</span><br><span class="line">    <span class="function">Page&lt;T&gt; <span class="title">findAll</span><span class="params">(Specification&lt;T&gt; spec, Pageable pageable)</span></span>;</span><br><span class="line">    <span class="function">List&lt;T&gt; <span class="title">findAll</span><span class="params">(Specification&lt;T&gt; spec, Sort sort)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">long</span> <span class="title">count</span><span class="params">(Specification&lt;T&gt; spec)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>可以看到提供了5个方法，方法的参数和返回值已经很明显的表达了其意图。其中的参数，Pageable和Sort应该是比较简单的，分别是分页参数和排序参数，而重点就是Specification参数，先看下这个接口的定义：</code></pre><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Specification</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function">Predicate <span class="title">toPredicate</span><span class="params">(Root&lt;T&gt; root, CriteriaQuery&lt;?&gt; query, CriteriaBuilder cb)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>其中就一个方法，返回的是动态查询的数据结构。</code></pre><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">javax.persistence.criteria.<span class="function">Predicate <span class="title">toPredicate</span><span class="params">(javax.persistence.criteria.Root&lt;T&gt; root,</span></span></span><br><span class="line"><span class="params"><span class="function">javax.persistence.criteria.CriteriaQuery&lt;?&gt; query,</span></span></span><br><span class="line"><span class="params"><span class="function">javax.persistence.criteria.CriteriaBuilder cb)</span></span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>这里使用的都是Java EE中的规范，具体实现本人采用的是Hibernate，当然也可以选择其他实现了JPA规范的数据持久层框架。这里需要再次回过头看看Criteria API中的一些东西：Predicate类：一个简单或复杂的谓词类型，用来拼接条件。Criteria 查询是以元模型的概念为基础的，元模型是为具体持久化单元的受管实体定义的，这些实体可以是实体类，嵌入类或者映射的父类。Root接口：代表Criteria查询的根对象，能够提供查询用到的数据库字段。CriteriaQuery接口：代表一个specific的顶层查询对象，用来执行最后的操作，它包含着查询的各个部分，比如：select 、from、where、group by、order by等注意：CriteriaQuery对象只对实体类型或嵌入式类型的Criteria查询起作用。CriteriaBuilder接口：表示具体的比较条件。其中支持的方法非常之强大，下面给出一个示例，大家可以参考一下，同样的，可以根据示例，自己可以写出更为复杂的查询。</code></pre><h3 id="代码举例"><a href="#代码举例" class="headerlink" title="代码举例"></a>代码举例</h3><ol><li>entity</li></ol><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.domain.support.AuditingEntityListener;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@EntityListeners(AuditingEntityListener.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String phone;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String name, String sex, String phone, Integer age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">        <span class="keyword">this</span>.phone = phone;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Long <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPhone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> phone;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPhone</span><span class="params">(String phone)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.phone = phone;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Integer age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, sex=&#x27;&quot;</span> + sex + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, phone=&#x27;&quot;</span> + phone + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>JPA代码</li></ol><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.wyh.jpatest.entity.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaSpecificationExecutor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">User</span>, <span class="title">Long</span>&gt;,  <span class="title">JpaSpecificationExecutor</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="3"><li>Service接口和Service实现类</li></ol><p>接口代码：</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">mport com.wyh.jpatest.entity.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Page;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Pageable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="function">Page&lt;User&gt; <span class="title">findByCondition</span><span class="params">(Integer page,  Integer size, String sex, Integer ageBegin, Integer ageEnd)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接口实现类代码：</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.wyh.jpatest.dao.UserRepository;</span><br><span class="line"><span class="keyword">import</span> com.wyh.jpatest.entity.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Page;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.PageRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Pageable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Sort;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.criteria.Predicate;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service(&quot;userService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserRepository userRepository;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Page&lt;User&gt; <span class="title">findByCondition</span><span class="params">(Integer page,  Integer size, String sex, Integer ageBegin, Integer ageEnd)</span> </span>&#123;</span><br><span class="line">        Pageable pageable = PageRequest.of(page, size);</span><br><span class="line">        <span class="keyword">return</span> userRepository.findAll((root, criteriaQuery, criteriaBuilder) -&gt; &#123;</span><br><span class="line">            List&lt;Predicate&gt; predicates = <span class="keyword">new</span> ArrayList&lt;Predicate&gt;();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!StringUtils.isEmpty(sex))&#123;             <span class="comment">//性别</span></span><br><span class="line">                predicates.add(criteriaBuilder.equal(root.get(<span class="string">&quot;sex&quot;</span>),sex));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (ageBegin != <span class="keyword">null</span>)&#123;          <span class="comment">//年龄大于ageBegin</span></span><br><span class="line">                predicates.add(criteriaBuilder.greaterThan(root.get(<span class="string">&quot;age&quot;</span>),ageBegin));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (ageEnd != <span class="keyword">null</span>)&#123;            <span class="comment">//年龄小于ageEnd</span></span><br><span class="line">                predicates.add(criteriaBuilder.lessThan(root.get(<span class="string">&quot;age&quot;</span>),ageEnd));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> criteriaQuery.where(predicates.toArray(<span class="keyword">new</span> Predicate[predicates.size()])).getRestriction();</span><br><span class="line">        &#125;,pageable);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="4"><li>Controller层</li></ol><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//page表示页数,默认是第0页</span></span><br><span class="line">    <span class="comment">//size表示每页显示条数，默认显示10条</span></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">findByCondition</span><span class="params">(<span class="meta">@RequestParam(value = &quot;page&quot;, defaultValue = &quot;0&quot;)</span> Integer page,</span></span></span><br><span class="line"><span class="params"><span class="function">                            <span class="meta">@RequestParam(value = &quot;size&quot;, defaultValue = &quot;10&quot;)</span> Integer size,</span></span></span><br><span class="line"><span class="params"><span class="function">                            <span class="meta">@RequestParam(value = &quot;sex&quot;, defaultValue = &quot;男&quot;)</span> String sex,</span></span></span><br><span class="line"><span class="params"><span class="function">                            <span class="meta">@RequestParam(value = &quot;ageBegin&quot;)</span> Integer ageBegin,</span></span></span><br><span class="line"><span class="params"><span class="function">                            <span class="meta">@RequestParam(value = &quot;ageEnd&quot;)</span> Integer ageEnd)</span></span>&#123;</span><br><span class="line">         List&lt;User&gt; list = userService.findByCondition(page, size, sex, ageBegin, ageEnd).getContent();</span><br><span class="line">         Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap();</span><br><span class="line">         map.put(<span class="string">&quot;num&quot;</span>, list.size());</span><br><span class="line">         map.put(<span class="string">&quot;listData&quot;</span>, list);</span><br><span class="line"></span><br><span class="line">         <span class="keyword">return</span> map;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="5"><li>application.properties配置代码</li></ol><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">spring.datasource.url=jdbc:mysql:<span class="comment">//localhost:3306/jpa?characterEncoding=utf-8&amp;useSSL=true&amp;serverTimezone=GMT%2b8</span></span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=<span class="number">123456</span></span><br><span class="line">spring.jpa.database=mysql</span><br><span class="line">spring.jpa.show-sql=<span class="keyword">true</span></span><br><span class="line">spring.jpa.hibernate.ddl-auto=update</span><br></pre></td></tr></table></figure><ol start="6"><li>测试结果<br> 查询年龄大于14，小于30，性别为男的用户，并返回第0页的数据，每页显示设置为3条数据。<br><img src="https://img-blog.csdnimg.cn/20210329154025243.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NfQl9NX1o=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li></ol>]]></content>
      
      
      <categories>
          
          <category> SpringBoot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Boot 集成Swagger-Bootstrap-UI</title>
      <link href="/2021/11/04/Spring%20Boot%20%E9%9B%86%E6%88%90Swagger-Bootstrap-UI/"/>
      <url>/2021/11/04/Spring%20Boot%20%E9%9B%86%E6%88%90Swagger-Bootstrap-UI/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="Spring-Boot-集成Swagger-Bootstrap-UI"><a href="#Spring-Boot-集成Swagger-Bootstrap-UI" class="headerlink" title="Spring Boot 集成Swagger-Bootstrap-UI"></a>Spring Boot 集成Swagger-Bootstrap-UI</h2><pre><code>    之前一直使用Swagger来作为接口文档的自动化,后来觉得实在是不好看,并且用着也不爽,直到发现swagger-bootstrap-ui,发现不光能帮助我进行接口归类,并且可以直接进行调试,有点取代postman的功能</code></pre><h4 id="引入依赖"><a href="#引入依赖" class="headerlink" title="引入依赖"></a>引入依赖</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;io.springfox&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">2.9</span><span class="number">.2</span>&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.github.xiaoymin&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;swagger-bootstrap-ui&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">1.9</span><span class="number">.6</span>&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h4 id="添加配置类"><a href="#添加配置类" class="headerlink" title="添加配置类"></a>添加配置类</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span></span><br><span class="line"><span class="meta">@ConditionalOnProperty(name = &quot;project.swagger-enabled&quot;, havingValue = &quot;true&quot;, matchIfMissing = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwaggerConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">createRestApi</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">                .groupName(<span class="string">&quot;默认接口&quot;</span>)</span><br><span class="line">                .apiInfo(apiInfo())</span><br><span class="line">                .select()</span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.xxx.controller&quot;</span>))</span><br><span class="line">                .paths(PathSelectors.any())</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> ApiInfo <span class="title">apiInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ApiInfoBuilder()</span><br><span class="line">                .title(<span class="string">&quot;XXXX系统&quot;</span>)</span><br><span class="line">                .description(<span class="string">&quot;XXX系统 Swagger2 接口列表&quot;</span>)</span><br><span class="line">                .termsOfServiceUrl(<span class="string">&quot;&quot;</span>)</span><br><span class="line">                .contact(<span class="keyword">new</span> Contact(<span class="string">&quot;xxx&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">                .version(<span class="string">&quot;v1.0&quot;</span>)</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="启动项目"><a href="#启动项目" class="headerlink" title="启动项目"></a>启动项目</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="meta">@Api(tags = &#123;&quot;xxxx&quot;&#125;, description = &quot;xxxx&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line"> <span class="keyword">private</span> UsersService usersService;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/list&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;xxxx&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Users&gt; <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> usersService.list();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="效果如下"><a href="#效果如下" class="headerlink" title="效果如下"></a>效果如下</h4><h5 id="1-首页"><a href="#1-首页" class="headerlink" title="1. 首页"></a>1. 首页</h5><p><img src="https://img-blog.csdnimg.cn/20210311105610189.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NfQl9NX1o=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h5 id="2-直接调试"><a href="#2-直接调试" class="headerlink" title="2. 直接调试"></a>2. 直接调试</h5><p><img src="https://img-blog.csdnimg.cn/20210311105707977.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NfQl9NX1o=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>]]></content>
      
      
      <categories>
          
          <category> SpringBoot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBoot 实现Excel读取</title>
      <link href="/2021/11/04/SpringBoot%20%E5%AE%9E%E7%8E%B0Excel%E8%AF%BB%E5%8F%96/"/>
      <url>/2021/11/04/SpringBoot%20%E5%AE%9E%E7%8E%B0Excel%E8%AF%BB%E5%8F%96/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="SpringBoot-实现Excel读取"><a href="#SpringBoot-实现Excel读取" class="headerlink" title="SpringBoot 实现Excel读取"></a>SpringBoot 实现Excel读取</h3><h4 id="1-创建ExcelPOJO实体类"><a href="#1-创建ExcelPOJO实体类" class="headerlink" title="1. 创建ExcelPOJO实体类"></a>1. 创建ExcelPOJO实体类</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.trgis.utils.Excel;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 实体类所有成员变量都需要有GET,SET方法</span></span><br><span class="line"><span class="comment"> * 所有成员变量都要加上注解<span class="doctag">@excelRescoure</span>(value = &quot;?&quot;),?为Excel真实列名，必须一一对应</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@excelRescoure</span>(value = &quot;?&quot;),?可为空,需要用到才赋值</span></span><br><span class="line"><span class="comment"> * 成员变量目前只允许String,Double,Interge,Float</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelPOJO</span>  </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPasswork</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> passwork;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPasswork</span><span class="params">(String passwork)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.passwork = passwork;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getLook</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> look;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLook</span><span class="params">(String look)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.look = look;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">   <span class="meta">@excelRescoure(value = &quot;XM&quot;)</span></span><br><span class="line">   <span class="keyword">private</span>  String name;</span><br><span class="line">   <span class="meta">@excelRescoure(value = &quot;SFZH&quot;)</span></span><br><span class="line">   <span class="keyword">private</span>  String passwork;</span><br><span class="line">   <span class="meta">@excelRescoure()</span></span><br><span class="line">   <span class="keyword">private</span>  String look;</span><br><span class="line"> </span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;name:&quot;</span>+<span class="keyword">this</span>.getName()+<span class="string">&quot;,passwork:&quot;</span>+<span class="keyword">this</span>.getPasswork()+<span class="string">&quot;,look:&quot;</span>+<span class="keyword">this</span>.getLook();</span><br><span class="line">    &#125;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">ExcelPOJO</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="2-interface自定义注解-用于实体类读取"><a href="#2-interface自定义注解-用于实体类读取" class="headerlink" title="2.interface自定义注解(用于实体类读取)"></a>2.<strong>interface自定义注解(用于实体类读取)</strong></h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.trgis.utils.Excel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target(ElementType.FIELD)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> excelRescoure &#123;</span><br><span class="line">    <span class="function">String <span class="title">value</span><span class="params">()</span> <span class="keyword">default</span> &quot;&quot;</span>;<span class="comment">//默认为空</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-excelRead类（读取Excel数据类）有很多冗余的代码，可抽离出来"><a href="#3-excelRead类（读取Excel数据类）有很多冗余的代码，可抽离出来" class="headerlink" title="3. excelRead类（读取Excel数据类）有很多冗余的代码，可抽离出来"></a>3. <strong>excelRead类（读取Excel数据类）有很多冗余的代码，可抽离出来</strong></h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.trgis.utils.Excel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONArray;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.bcel.internal.generic.NEW;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.HSSFWorkbook;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.formula.functions.T;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Cell;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Row;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Sheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Workbook;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.Source;</span><br><span class="line"><span class="keyword">import</span> java.beans.IntrospectionException;</span><br><span class="line"><span class="keyword">import</span> java.beans.PropertyDescriptor;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">import</span> java.text.DecimalFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">excelRead</span> </span>&#123;</span><br><span class="line">    <span class="comment">//日志输出</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Logger logger = LoggerFactory.getLogger(excelRead.class);</span><br><span class="line">    <span class="comment">//定义excel类型</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String XLS = <span class="string">&quot;xls&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String XLSX = <span class="string">&quot;xlsx&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据文件后缀名类型获取对应的工作簿对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> inputStream 读取文件的输入流</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fileType    文件后缀名类型（xls或xlsx）</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 包含文件数据的工作簿对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Workbook <span class="title">getWorkbook</span><span class="params">(InputStream inputStream, String fileType)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//用自带的方法新建工作薄</span></span><br><span class="line">        Workbook workbook = WorkbookFactory.create(inputStream);</span><br><span class="line">        <span class="comment">//后缀判断有版本转换问题</span></span><br><span class="line">        <span class="comment">//Workbook workbook = null;</span></span><br><span class="line">        <span class="comment">//if (fileType.equalsIgnoreCase(XLS)) &#123;</span></span><br><span class="line">        <span class="comment">//    workbook = new HSSFWorkbook(inputStream);</span></span><br><span class="line">        <span class="comment">//&#125; else if (fileType.equalsIgnoreCase(XLSX)) &#123;</span></span><br><span class="line">        <span class="comment">//    workbook = new XSSFWorkbook(inputStream);</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">        <span class="keyword">return</span> workbook;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将单元格内容转换为字符串</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> cell</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">convertCellValueToString</span><span class="params">(Cell cell)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (cell == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        String returnValue = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">switch</span> (cell.getCellType()) &#123;</span><br><span class="line">            <span class="keyword">case</span> NUMERIC:   <span class="comment">//数字</span></span><br><span class="line">                Double doubleValue = cell.getNumericCellValue();</span><br><span class="line">                <span class="comment">// 格式化科学计数法，取一位整数，如取小数，值如0.0,取小数点后几位就写几个0</span></span><br><span class="line">                DecimalFormat df = <span class="keyword">new</span> DecimalFormat(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">                returnValue = df.format(doubleValue);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> STRING:    <span class="comment">//字符串</span></span><br><span class="line">                returnValue = cell.getStringCellValue();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> BOOLEAN:   <span class="comment">//布尔</span></span><br><span class="line">                Boolean booleanValue = cell.getBooleanCellValue();</span><br><span class="line">                returnValue = booleanValue.toString();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> BLANK:     <span class="comment">// 空值</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> FORMULA:   <span class="comment">// 公式</span></span><br><span class="line">                returnValue = cell.getCellFormula();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> ERROR:     <span class="comment">// 故障</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> returnValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 处理Excel内容转为List&lt;Map&lt;String,Object&gt;&gt;输出</span></span><br><span class="line"><span class="comment">     * workbook：已连接的工作薄</span></span><br><span class="line"><span class="comment">     * StatrRow：读取的开始行数（默认填0，0开始,传过来是EXcel的行数值默认从1开始，这里已处理减1）</span></span><br><span class="line"><span class="comment">     * EndRow：读取的结束行数（填-1为全部）</span></span><br><span class="line"><span class="comment">     * ExistTop:是否存在头部（如存在则读取数据时会把头部拼接到对应数据，若无则为当前列数）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Map&lt;String, Object&gt;&gt; HandleData(Workbook workbook, <span class="keyword">int</span> StatrRow, <span class="keyword">int</span> EndRow, <span class="keyword">boolean</span> ExistTop) &#123;</span><br><span class="line">        <span class="comment">//声明返回结果集result</span></span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="comment">//声明一个Excel头部函数</span></span><br><span class="line">        ArrayList&lt;String&gt; top = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="comment">//解析sheet（sheet是Excel脚页）</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">        *此处会读取所有脚页的行数据，若只想读取指定页，不要for循环，直接给sheetNum赋值，脚页从0开始（通常情况Excel都只有一页，所以此处未进行进一步处理）</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> sheetNum = <span class="number">0</span>; sheetNum &lt; workbook.getNumberOfSheets(); sheetNum++) &#123;</span><br><span class="line">            Sheet sheet = workbook.getSheetAt(sheetNum);</span><br><span class="line">            <span class="comment">// 校验sheet是否合法</span></span><br><span class="line">            <span class="keyword">if</span> (sheet == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//如存在头部，处理头部数据</span></span><br><span class="line">            <span class="keyword">if</span> (ExistTop) &#123;</span><br><span class="line">                <span class="keyword">int</span> firstRowNum = sheet.getFirstRowNum();</span><br><span class="line">                Row firstRow = sheet.getRow(firstRowNum);</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> == firstRow) &#123;</span><br><span class="line">                    logger.warn(<span class="string">&quot;解析Excel失败，在第一行没有读取到任何数据！&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; firstRow.getLastCellNum(); i++) &#123;</span><br><span class="line">                    top.add(convertCellValueToString(firstRow.getCell(i)));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//处理Excel数据内容</span></span><br><span class="line">            <span class="keyword">int</span> endRowNum;</span><br><span class="line">            <span class="comment">//获取结束行数</span></span><br><span class="line">            <span class="keyword">if</span> (EndRow == -<span class="number">1</span>) &#123;</span><br><span class="line">                endRowNum = sheet.getPhysicalNumberOfRows();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                endRowNum = EndRow &lt;= sheet.getPhysicalNumberOfRows() ? EndRow : sheet.getPhysicalNumberOfRows();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//遍历行数</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = StatrRow - <span class="number">1</span>; i &lt; endRowNum; i++) &#123;</span><br><span class="line">                Row row = sheet.getRow(i);</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> == row) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">                <span class="comment">//获取所有列数据</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">0</span>; y &lt; row.getLastCellNum(); y++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (top.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (top.size() &gt;= y) &#123;</span><br><span class="line">                            map.put(top.get(y), convertCellValueToString(row.getCell(y)));</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            map.put(String.valueOf(y + <span class="number">1</span>), convertCellValueToString(row.getCell(y)));</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        map.put(String.valueOf(y + <span class="number">1</span>), convertCellValueToString(row.getCell(y)));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                result.add(map);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 方法一</span></span><br><span class="line"><span class="comment">     * 根据行数和列数读取Excel</span></span><br><span class="line"><span class="comment">     * fileName:Excel文件路径</span></span><br><span class="line"><span class="comment">     * StatrRow：读取的开始行数（默认填0）</span></span><br><span class="line"><span class="comment">     * EndRow：读取的结束行数（填-1为全部）</span></span><br><span class="line"><span class="comment">     * ExistTop:是否存在头部（如存在则读取数据时会把头部拼接到对应数据，若无则为当前列数）</span></span><br><span class="line"><span class="comment">     * 返回一个List&lt;Map&lt;String,Object&gt;&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Map&lt;String, Object&gt;&gt; ReadExcelByRC(String fileName, <span class="keyword">int</span> StatrRow, <span class="keyword">int</span> EndRow, <span class="keyword">boolean</span> ExistTop) &#123;</span><br><span class="line">        <span class="comment">//判断输入的开始值是否少于等于结束值</span></span><br><span class="line">        <span class="keyword">if</span> (StatrRow &gt; EndRow &amp;&amp; EndRow != -<span class="number">1</span>) &#123;</span><br><span class="line">            logger.warn(<span class="string">&quot;输入的开始行值比结束行值大，请重新输入正确的行数&quot;</span>);</span><br><span class="line">            List&lt;Map&lt;String, Object&gt;&gt; error = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">return</span> error;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//声明返回的结果集</span></span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="comment">//声明一个工作薄</span></span><br><span class="line">        Workbook workbook = <span class="keyword">null</span>;</span><br><span class="line">        <span class="comment">//声明一个文件输入流</span></span><br><span class="line">        FileInputStream inputStream = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 获取Excel后缀名，判断文件类型</span></span><br><span class="line">            String fileType = fileName.substring(fileName.lastIndexOf(<span class="string">&quot;.&quot;</span>) + <span class="number">1</span>);</span><br><span class="line">            <span class="comment">// 获取Excel文件</span></span><br><span class="line">            File excelFile = <span class="keyword">new</span> File(fileName);</span><br><span class="line">            <span class="keyword">if</span> (!excelFile.exists()) &#123;</span><br><span class="line">                logger.warn(<span class="string">&quot;指定的Excel文件不存在！&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 获取Excel工作簿</span></span><br><span class="line">            inputStream = <span class="keyword">new</span> FileInputStream(excelFile);</span><br><span class="line">            workbook = getWorkbook(inputStream, fileType);</span><br><span class="line">            <span class="comment">//处理Excel内容</span></span><br><span class="line">            result = HandleData(workbook, StatrRow, EndRow, ExistTop);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logger.warn(<span class="string">&quot;解析Excel失败，文件名：&quot;</span> + fileName + <span class="string">&quot; 错误信息：&quot;</span> + e.getMessage());</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != workbook) &#123;</span><br><span class="line">                    workbook.close();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != inputStream) &#123;</span><br><span class="line">                    inputStream.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                logger.warn(<span class="string">&quot;关闭数据流出错！错误信息：&quot;</span> + e.getMessage());</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**==============================================================================================================================**/</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 方法二</span></span><br><span class="line"><span class="comment">     * 根据给定的实体类中赋值的注解值读取Excel</span></span><br><span class="line"><span class="comment">     * fileName:Excel文件路径</span></span><br><span class="line"><span class="comment">     * StatrRow：读取的开始行数（默认填0）</span></span><br><span class="line"><span class="comment">     * EndRow：读取的结束行数（填-1为全部）</span></span><br><span class="line"><span class="comment">     * Class&lt;T&gt;：传过来的实体类类型</span></span><br><span class="line"><span class="comment">     * 返回一个List&lt;T&gt;:T为实体类</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Object&gt; <span class="title">ReadExcelByPOJO</span><span class="params">(String fileName, <span class="keyword">int</span> StatrRow, <span class="keyword">int</span> EndRow, Class t)</span> <span class="keyword">throws</span> InvocationTargetException, IntrospectionException, InstantiationException, IllegalAccessException, NoSuchFieldException </span>&#123;</span><br><span class="line">        <span class="comment">//判断输入的开始值是否少于等于结束值</span></span><br><span class="line">        <span class="keyword">if</span> (StatrRow &gt; EndRow &amp;&amp; EndRow != -<span class="number">1</span>) &#123;</span><br><span class="line">            logger.warn(<span class="string">&quot;输入的开始行值比结束行值大，请重新输入正确的行数&quot;</span>);</span><br><span class="line">            List&lt;Object&gt; error = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">return</span> error;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//声明返回的结果集</span></span><br><span class="line">        List&lt;Object&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="comment">//声明一个工作薄</span></span><br><span class="line">        Workbook workbook = <span class="keyword">null</span>;</span><br><span class="line">        <span class="comment">//声明一个文件输入流</span></span><br><span class="line">        FileInputStream inputStream = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 获取Excel后缀名，判断文件类型</span></span><br><span class="line">            String fileType = fileName.substring(fileName.lastIndexOf(<span class="string">&quot;.&quot;</span>) + <span class="number">1</span>);</span><br><span class="line">            <span class="comment">// 获取Excel文件</span></span><br><span class="line">            File excelFile = <span class="keyword">new</span> File(fileName);</span><br><span class="line">            <span class="keyword">if</span> (!excelFile.exists()) &#123;</span><br><span class="line">                logger.warn(<span class="string">&quot;指定的Excel文件不存在！&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 获取Excel工作簿</span></span><br><span class="line">            inputStream = <span class="keyword">new</span> FileInputStream(excelFile);</span><br><span class="line">            workbook = getWorkbook(inputStream, fileType);</span><br><span class="line">            <span class="comment">//处理Excel内容</span></span><br><span class="line">            result = HandleDataPOJO(workbook, StatrRow, EndRow, t);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logger.warn(<span class="string">&quot;解析Excel失败，文件名：&quot;</span> + fileName + <span class="string">&quot; 错误信息：&quot;</span> + e.getMessage());</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != workbook) &#123;</span><br><span class="line">                    workbook.close();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != inputStream) &#123;</span><br><span class="line">                    inputStream.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                logger.warn(<span class="string">&quot;关闭数据流出错！错误信息：&quot;</span> + e.getMessage());</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 处理Excel内容转为List&lt;T&gt;输出</span></span><br><span class="line"><span class="comment">     * workbook：已连接的工作薄</span></span><br><span class="line"><span class="comment">     * StatrRow：读取的开始行数（默认填0，0开始,传过来是EXcel的行数值默认从1开始，这里已处理减1）</span></span><br><span class="line"><span class="comment">     * EndRow：读取的结束行数（填-1为全部）</span></span><br><span class="line"><span class="comment">     * Class&lt;T&gt;：所映射的实体类</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> &lt;t&gt; <span class="function">List&lt;Object&gt; <span class="title">HandleDataPOJO</span><span class="params">(Workbook workbook, <span class="keyword">int</span> StatrRow, <span class="keyword">int</span> EndRow, Class&lt;?&gt; t)</span> <span class="keyword">throws</span> IntrospectionException, NoSuchFieldException, IllegalAccessException, InstantiationException, InvocationTargetException, ClassNotFoundException </span>&#123;</span><br><span class="line">        <span class="comment">//声明返回的结果集</span></span><br><span class="line">        List&lt;Object&gt; result = <span class="keyword">new</span> ArrayList&lt;Object&gt;();</span><br><span class="line">        <span class="comment">//解析sheet（sheet是Excel脚页）</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> sheetNum = <span class="number">0</span>; sheetNum &lt; workbook.getNumberOfSheets(); sheetNum++) &#123;</span><br><span class="line">            Sheet sheet = workbook.getSheetAt(sheetNum);</span><br><span class="line">            <span class="comment">// 校验sheet是否合法</span></span><br><span class="line">            <span class="keyword">if</span> (sheet == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//获取头部数据</span></span><br><span class="line">            <span class="comment">//声明头部数据数列对象</span></span><br><span class="line">            ArrayList&lt;String&gt; top = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            <span class="comment">//获取Excel第一行数据</span></span><br><span class="line">            <span class="keyword">int</span> firstRowNum = sheet.getFirstRowNum();</span><br><span class="line">            Row firstRow = sheet.getRow(firstRowNum);</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">null</span> == firstRow) &#123;</span><br><span class="line">                logger.warn(<span class="string">&quot;解析Excel失败，在第一行没有读取到任何数据！&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; firstRow.getLastCellNum(); i++) &#123;</span><br><span class="line">                top.add(convertCellValueToString(firstRow.getCell(i)));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//获取实体类的成原变量</span></span><br><span class="line">            Map&lt;String, Object&gt; POJOfields = getPOJOFieldAndValue(t);</span><br><span class="line">            <span class="comment">//判断所需要的数据列</span></span><br><span class="line">            Map&lt;String, Object&gt; exceltoPOJO = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; top.size(); i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (POJOfields.get(top.get(i)) != <span class="keyword">null</span> &amp;&amp; !<span class="string">&quot;&quot;</span>.equals(POJOfields.get(top.get(i)))) &#123;</span><br><span class="line">                    exceltoPOJO.put(String.valueOf(i), POJOfields.get(top.get(i)));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">/*处理Excel数据内容*/</span></span><br><span class="line">            <span class="keyword">int</span> endRowNum;</span><br><span class="line">            <span class="comment">//获取结束行数</span></span><br><span class="line">            <span class="keyword">if</span> (EndRow == -<span class="number">1</span>) &#123;</span><br><span class="line">                endRowNum = sheet.getPhysicalNumberOfRows();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                endRowNum = EndRow &lt;= sheet.getPhysicalNumberOfRows() ? EndRow : sheet.getPhysicalNumberOfRows();</span><br><span class="line">            &#125;</span><br><span class="line">            List&lt;Map&lt;String, Object&gt;&gt; mapList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            <span class="comment">//遍历行数</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = StatrRow - <span class="number">1</span>; i &lt; endRowNum; i++) &#123;</span><br><span class="line">                Row row = sheet.getRow(i);</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> == row) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//获取需要的列数据</span></span><br><span class="line">                t texcel = (t) t.newInstance();</span><br><span class="line">                <span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; map : exceltoPOJO.entrySet()) &#123;</span><br><span class="line">                    <span class="comment">//获取Exceld对应列的数据</span></span><br><span class="line">                    String celldata = convertCellValueToString(row.getCell(Integer.parseInt(map.getKey())));</span><br><span class="line">                    <span class="comment">//使用发射</span></span><br><span class="line">                    <span class="comment">//获取实体类T中指定成员变量的对象</span></span><br><span class="line">                    PropertyDescriptor pd = <span class="keyword">new</span> PropertyDescriptor((String) map.getValue(), texcel.getClass());</span><br><span class="line">                    <span class="comment">//获取成员变量的set方法</span></span><br><span class="line">                    Method method = pd.getWriteMethod();</span><br><span class="line">                    <span class="comment">//判断成员变量的类型</span></span><br><span class="line">                    Field field = texcel.getClass().getDeclaredField((String) map.getValue());</span><br><span class="line">                    String object = field.getGenericType().getTypeName();</span><br><span class="line">                    <span class="keyword">if</span> (object.endsWith(<span class="string">&quot;String&quot;</span>)) &#123;</span><br><span class="line">                        <span class="comment">//执行set方法</span></span><br><span class="line">                        method.invoke(texcel, celldata);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (object.endsWith(<span class="string">&quot;Double&quot;</span>)) &#123;</span><br><span class="line">                        Double middata = Double.valueOf(celldata);</span><br><span class="line">                        <span class="comment">//执行set方法</span></span><br><span class="line">                        method.invoke(texcel, middata);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (object.endsWith(<span class="string">&quot;Float&quot;</span>)) &#123;</span><br><span class="line">                        Float middata = Float.valueOf(celldata);</span><br><span class="line">                        <span class="comment">//执行set方法</span></span><br><span class="line">                        method.invoke(texcel, middata);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (object.endsWith(<span class="string">&quot;Integer&quot;</span>)) &#123;</span><br><span class="line">                        Integer middata = Integer.parseInt(celldata);</span><br><span class="line">                        <span class="comment">//执行set方法</span></span><br><span class="line">                        method.invoke(texcel, middata);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                result.add(texcel);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取对应的实体类成员</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title">getPOJOFieldAndValue</span><span class="params">(Class T)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//声明返回结果集</span></span><br><span class="line">        Map&lt;String, Object&gt; result = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        Field[] fields = T.getDeclaredFields();<span class="comment">//获取属性名</span></span><br><span class="line">        <span class="keyword">if</span> (fields != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">                excelRescoure Rescoure = field.getAnnotation(excelRescoure.class);</span><br><span class="line">                <span class="keyword">if</span> (Rescoure.value() != <span class="keyword">null</span> &amp;&amp; !<span class="string">&quot;&quot;</span>.equals(Rescoure.value())) &#123;</span><br><span class="line">                    result.put(Rescoure.value(), field.getName());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            logger.warn(<span class="string">&quot;实体类：&quot;</span> + T + <span class="string">&quot;不存在成员变量&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> SpringBoot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBoot 中实现跨域的5种方式</title>
      <link href="/2021/11/04/SpringBoot%20%E4%B8%AD%E5%AE%9E%E7%8E%B0%E8%B7%A8%E5%9F%9F/"/>
      <url>/2021/11/04/SpringBoot%20%E4%B8%AD%E5%AE%9E%E7%8E%B0%E8%B7%A8%E5%9F%9F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="SpringBoot-中实现跨域的5种方式"><a href="#SpringBoot-中实现跨域的5种方式" class="headerlink" title="SpringBoot 中实现跨域的5种方式"></a>SpringBoot 中实现跨域的5种方式</h3><h4 id="一、为什么会出现跨域问题"><a href="#一、为什么会出现跨域问题" class="headerlink" title="一、为什么会出现跨域问题"></a>一、为什么会出现跨域问题</h4><pre><code>    出于浏览器的同源策略限制。同源策略（Sameoriginpolicy）是一种约定，它是浏览器最核心也最基本的安全功能，如果缺少了同源策略，则浏览器的正常功能可能都会受到影响。可以说Web是构建在同源策略基础之上的，浏览器只是针对同源策略的一种实现。    同源策略会阻止一个域的javascript脚本和另外一个域的内容进行交互。所谓同源（即指在同一个域）就是两个页面具有相同的协议（protocol），主机（host）和端口号（port）</code></pre><h4 id="二、什么是跨域"><a href="#二、什么是跨域" class="headerlink" title="二、什么是跨域"></a>二、什么是跨域</h4><pre><code>    当一个请求url的协议、域名、端口三者之间任意一个与当前页面url不同即为跨域</code></pre><p>图片</p><h4 id="三、非同源限制"><a href="#三、非同源限制" class="headerlink" title="三、非同源限制"></a>三、非同源限制</h4><p>【1】无法读取非同源网页的 Cookie、LocalStorage 和 IndexedDB</p><p>【2】无法接触非同源网页的 DOM</p><p>【3】无法向非同源地址发送 AJAX 请求</p><h4 id="四、java-后端-实现-CORS-跨域请求的方式"><a href="#四、java-后端-实现-CORS-跨域请求的方式" class="headerlink" title="四、java 后端 实现 CORS 跨域请求的方式"></a>四、java 后端 实现 CORS 跨域请求的方式</h4><p>对于 CORS的跨域请求，主要有以下几种方式可供选择：</p><p>【1】返回新的CorsFilter</p><p>【2】重写 WebMvcConfigurer</p><p>【3】使用注解 @CrossOrigin</p><p>【4】手动设置响应头 (HttpServletResponse)</p><p>【5】自定web filter 实现跨域</p><p>注意:</p><pre><code>    CorFilter / WebMvConfigurer / @CrossOrigin 需要 SpringMVC 4.2以上版本才支持，对应springBoot 1.3版本以上    上面前两种方式属于全局 CORS 配置，后两种属于局部 CORS配置。如果使用了局部跨域是会覆盖全局跨域的规则，所以可以通过 @CrossOrigin 注解来进行细粒度更高的跨域资源控制。    其实无论哪种方案，最终目的都是修改响应头，向响应头中添加浏览器所要求的数据，进而实现跨域。</code></pre><h5 id="1-返回新的-CorsFilter-全局跨域"><a href="#1-返回新的-CorsFilter-全局跨域" class="headerlink" title="1.返回新的 CorsFilter(全局跨域)"></a>1.返回新的 CorsFilter(全局跨域)</h5><p>在任意配置类，返回一个 新的 CorsFIlter Bean ，并添加映射路径和具体的CORS配置路径。</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GlobalCorsConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CorsFilter <span class="title">corsFilter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1. 添加 CORS配置信息</span></span><br><span class="line">        CorsConfiguration config = <span class="keyword">new</span> CorsConfiguration();</span><br><span class="line">        <span class="comment">//放行哪些原始域</span></span><br><span class="line">        config.addAllowedOrigin(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">        <span class="comment">//是否发送 Cookie</span></span><br><span class="line">        config.setAllowCredentials(<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">//放行哪些请求方式</span></span><br><span class="line">        config.addAllowedMethod(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">        <span class="comment">//放行哪些原始请求头部信息</span></span><br><span class="line">        config.addAllowedHeader(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">        <span class="comment">//暴露哪些头部信息</span></span><br><span class="line">        config.addExposedHeader(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">        <span class="comment">//2. 添加映射路径</span></span><br><span class="line">        UrlBasedCorsConfigurationSource corsConfigurationSource = <span class="keyword">new</span> UrlBasedCorsConfigurationSource();</span><br><span class="line">        corsConfigurationSource.registerCorsConfiguration(<span class="string">&quot;/**&quot;</span>,config);</span><br><span class="line">        <span class="comment">//3. 返回新的CorsFilter</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CorsFilter(corsConfigurationSource);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="2-重写-WebMvcConfigurer-全局跨域"><a href="#2-重写-WebMvcConfigurer-全局跨域" class="headerlink" title="2. 重写 WebMvcConfigurer(全局跨域)"></a>2. 重写 WebMvcConfigurer(全局跨域)</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CorsConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addMapping(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">                <span class="comment">//是否发送Cookie</span></span><br><span class="line">                .allowCredentials(<span class="keyword">true</span>)</span><br><span class="line">                <span class="comment">//放行哪些原始域</span></span><br><span class="line">                .allowedOrigins(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">                .allowedMethods(<span class="keyword">new</span> String[]&#123;<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;PUT&quot;</span>, <span class="string">&quot;DELETE&quot;</span>&#125;)</span><br><span class="line">                .allowedHeaders(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">                .exposedHeaders(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h5 id="3-使用注解-局部跨域"><a href="#3-使用注解-局部跨域" class="headerlink" title="3. 使用注解 (局部跨域)"></a>3. 使用注解 (局部跨域)</h5><p>在控制器(类上)上使用注解 @CrossOrigin:，表示该类的所有方法允许跨域。</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin(origins = &quot;*&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在方法上使用注解 @CrossOrigin:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="meta">@CrossOrigin(origins = &quot;*&quot;)</span></span><br><span class="line">     <span class="comment">//@CrossOrigin(value = &quot;http://localhost:8081&quot;) //指定具体ip允许跨域</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h5 id="4-手动设置响应头-局部跨域"><a href="#4-手动设置响应头-局部跨域" class="headerlink" title="4. 手动设置响应头(局部跨域)"></a>4. 手动设置响应头(局部跨域)</h5><p>使用 HttpServletResponse 对象添加响应头(Access-Control-Allow-Origin)来授权原始域，这里 Origin的值也可以设置为 “*”,表示全部放行。推荐：150道常见的Java面试题分解汇总</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/index&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">(HttpServletResponse response)</span> </span>&#123;</span><br><span class="line">    response.addHeader(<span class="string">&quot;Access-Allow-Control-Origin&quot;</span>,<span class="string">&quot;*&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="5-使用自定义filter实现跨域"><a href="#5-使用自定义filter实现跨域" class="headerlink" title="5. 使用自定义filter实现跨域"></a>5. 使用自定义filter实现跨域</h6><p>首先编写一个过滤器，可以起名字为MyCorsFilter.java</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mesnac.aop;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.Filter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterChain;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyCorsFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest req, ServletResponse res, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">    HttpServletResponse response = (HttpServletResponse) res;</span><br><span class="line">    response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">    response.setHeader(<span class="string">&quot;Access-Control-Allow-Methods&quot;</span>, <span class="string">&quot;POST, GET, OPTIONS, DELETE&quot;</span>);</span><br><span class="line">    response.setHeader(<span class="string">&quot;Access-Control-Max-Age&quot;</span>, <span class="string">&quot;3600&quot;</span>);</span><br><span class="line">    response.setHeader(<span class="string">&quot;Access-Control-Allow-Headers&quot;</span>, <span class="string">&quot;x-requested-with,content-type&quot;</span>);</span><br><span class="line">    chain.doFilter(req, res);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> </span>&#123;&#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在web.xml中配置这个过滤器，使其生效</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 跨域访问 START--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CorsFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.mesnac.aop.MyCorsFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CorsFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 跨域访问 END  --&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> SpringBoot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBoot+Vue+Nginx项目部署</title>
      <link href="/2021/11/04/SpringBoot+Vue%E9%A1%B9%E7%9B%AENginx%E9%83%A8%E7%BD%B2/"/>
      <url>/2021/11/04/SpringBoot+Vue%E9%A1%B9%E7%9B%AENginx%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="SpringBoot-Vue-Nginx项目部署"><a href="#SpringBoot-Vue-Nginx项目部署" class="headerlink" title="SpringBoot+Vue+Nginx项目部署"></a>SpringBoot+Vue+Nginx项目部署</h3><p>   基于SpringBoot + Vue +Nginx 项目打包部署  ,前提是我们开发完成 . 进行项目的部署，使用nginx部署服务器 . </p><ul><li>[前端 ] Vue + Nginx</li></ul><ol><li>进行项目打包<br><img src="https://img-blog.csdnimg.cn/20210310145716423.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NfQl9NX1o=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li><li>将此文件夹复制到Nginx目录下,然后去修改Nginx,config文件<br><img src="https://img-blog.csdnimg.cn/20210310150035740.png" alt="在这里插入图片描述"></li><li>修改Nginx.config文件</li></ol><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment">#user  nobody;</span></span><br><span class="line"><span class="string">worker_processes</span>  <span class="number">1</span><span class="string">;</span></span><br><span class="line"><span class="comment">#error_log  logs/error.log;</span></span><br><span class="line"><span class="comment">#error_log  logs/error.log  notice;</span></span><br><span class="line"><span class="comment">#error_log  logs/error.log  info;</span></span><br><span class="line"><span class="comment">#pid        logs/nginx.pid;</span></span><br><span class="line"><span class="string">events</span> &#123;</span><br><span class="line">    <span class="string">worker_connections</span>  <span class="number">1024</span><span class="string">;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="string">http</span> &#123;</span><br><span class="line">    <span class="string">include</span>       <span class="string">mime.types;</span></span><br><span class="line">    <span class="string">default_type</span>  <span class="string">application/octet-stream;</span></span><br><span class="line">   <span class="comment">#log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span></span><br><span class="line">    <span class="comment">#                  &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span></span><br><span class="line">    <span class="comment">#                  &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span></span><br><span class="line">    <span class="comment">#access_log  logs/access.log  main;</span></span><br><span class="line">    <span class="string">sendfile</span>        <span class="string">on;</span></span><br><span class="line">    <span class="comment">#tcp_nopush     on;</span></span><br><span class="line">    <span class="comment">#keepalive_timeout  0;</span></span><br><span class="line">    <span class="string">keepalive_timeout</span>  <span class="number">65</span><span class="string">;</span></span><br><span class="line">    <span class="comment">#gzip  on;</span></span><br><span class="line"><span class="comment">#   server &#123;</span></span><br><span class="line"><span class="comment">#        listen       8080;</span></span><br><span class="line"><span class="comment">#        server_name  localhost;</span></span><br><span class="line">        <span class="comment">#charset koi8-r;</span></span><br><span class="line">        <span class="comment">#access_log  logs/host.access.log  main;</span></span><br><span class="line"><span class="comment">#        location / &#123;</span></span><br><span class="line"><span class="comment">#            root   html/dist/;        #项目根目录</span></span><br><span class="line"><span class="comment">#            index  index.html index.htm;</span></span><br><span class="line"><span class="comment">#            try_files $uri $uri/ /index.html;  #防止刷新报404</span></span><br><span class="line"><span class="comment">#        &#125;    </span></span><br><span class="line">        <span class="comment">#error_page  404              /404.html;</span></span><br><span class="line">        <span class="comment"># redirect server error pages to the static page /50x.html</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line"><span class="comment">#        error_page   500 502 503 504  /50x.html;</span></span><br><span class="line"><span class="comment">#        location = /50x.html &#123;</span></span><br><span class="line"><span class="comment">#            root   html;</span></span><br><span class="line"><span class="comment">#        &#125;</span></span><br><span class="line">        <span class="comment"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">        <span class="comment">#    proxy_pass   http://127.0.0.1;</span></span><br><span class="line">        <span class="comment">#&#125;</span></span><br><span class="line">        <span class="comment"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">        <span class="comment">#    root           html;</span></span><br><span class="line">        <span class="comment">#    fastcgi_pass   127.0.0.1:9000;</span></span><br><span class="line">        <span class="comment">#    fastcgi_index  index.php;</span></span><br><span class="line">        <span class="comment">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span></span><br><span class="line">        <span class="comment">#    include        fastcgi_params;</span></span><br><span class="line">        <span class="comment">#&#125;</span></span><br><span class="line">        <span class="comment"># deny access to .htaccess files, if Apache&#x27;s document root</span></span><br><span class="line">        <span class="comment"># concurs with nginx&#x27;s one</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#location ~ /\.ht &#123;</span></span><br><span class="line">        <span class="comment">#    deny  all;</span></span><br><span class="line">        <span class="comment">#&#125;</span></span><br><span class="line"><span class="comment">#    &#125;  </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 一个server代表一个服务  </span></span><br><span class="line">    <span class="string">server</span> &#123;</span><br><span class="line">        <span class="string">listen</span>       <span class="number">80</span><span class="string">;</span> <span class="comment"># 服务端口</span></span><br><span class="line">        <span class="string">server_name</span>  <span class="string">localhost;</span> <span class="comment">#服务ip</span></span><br><span class="line">        <span class="comment">#charset koi8-r;</span></span><br><span class="line">        <span class="comment">#access_log  logs/host.access.log  main; </span></span><br><span class="line">         </span><br><span class="line">        <span class="comment"># 前端服务配置   </span></span><br><span class="line">    <span class="string">location</span> <span class="string">/</span> &#123;</span><br><span class="line">             <span class="string">root</span> <span class="string">dist;</span></span><br><span class="line"><span class="string">try_files</span> <span class="string">$uri</span> <span class="string">$uri/</span> <span class="string">@router;</span></span><br><span class="line">            <span class="string">index</span>  <span class="string">index.html</span> <span class="string">index.htm;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="string">location</span> <span class="string">@router</span> &#123;</span><br><span class="line">            <span class="string">rewrite</span> <span class="string">^.*$</span> <span class="string">/index.html</span> <span class="string">last;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># 后端服务的配置</span></span><br><span class="line">        <span class="string">location</span> <span class="string">/elect/</span> &#123;</span><br><span class="line">                <span class="string">proxy_redirect</span> <span class="string">off;</span></span><br><span class="line">                <span class="string">proxy_set_header</span> <span class="string">Host</span> <span class="string">$host;</span></span><br><span class="line">                <span class="string">proxy_set_header</span> <span class="string">X-Real-IP</span> <span class="string">$remote_addr;</span></span><br><span class="line">                <span class="string">proxy_set_header</span> <span class="string">X-Forwarded-For</span> <span class="string">$proxy_add_x_forwarded_for;</span></span><br><span class="line">                <span class="comment"># 后端服务地址</span></span><br><span class="line">                 <span class="string">proxy_pass</span> <span class="string">http://localhost:9999;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="string">error_page</span>   <span class="number">500</span> <span class="number">502</span> <span class="number">503</span> <span class="number">504</span>  <span class="string">/50x.html;</span></span><br><span class="line">        <span class="string">location</span> <span class="string">=</span> <span class="string">/50x.html</span> &#123;</span><br><span class="line">            <span class="string">root</span>   <span class="string">html;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"># another virtual host using mix of IP-, name-, and port-based configuration</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#server &#123;</span></span><br><span class="line">    <span class="comment">#    listen       8000;</span></span><br><span class="line">    <span class="comment">#    listen       somename:8080;</span></span><br><span class="line">    <span class="comment">#    server_name  somename  alias  another.alias;</span></span><br><span class="line">    <span class="comment">#    location / &#123;</span></span><br><span class="line">    <span class="comment">#        root   html;</span></span><br><span class="line">    <span class="comment">#        index  index.html index.htm;</span></span><br><span class="line">    <span class="comment">#    &#125;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line">    <span class="comment"># HTTPS server</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#server &#123;</span></span><br><span class="line">    <span class="comment">#    listen       443 ssl;</span></span><br><span class="line">    <span class="comment">#    server_name  localhost;</span></span><br><span class="line">    <span class="comment">#    ssl_certificate      cert.pem;</span></span><br><span class="line">    <span class="comment">#    ssl_certificate_key  cert.key;</span></span><br><span class="line">    <span class="comment">#    ssl_session_cache    shared:SSL:1m;</span></span><br><span class="line">    <span class="comment">#    ssl_session_timeout  5m;</span></span><br><span class="line">    <span class="comment">#    ssl_ciphers  HIGH:!aNULL:!MD5;</span></span><br><span class="line">    <span class="comment">#    ssl_prefer_server_ciphers  on;</span></span><br><span class="line">    <span class="comment">#    location / &#123;</span></span><br><span class="line">    <span class="comment">#        root   html;</span></span><br><span class="line">    <span class="comment">#        index  index.html index.htm;</span></span><br><span class="line">    <span class="comment">#    &#125;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>双击启动Nginx 进行服务访问</li></ol><ul><li>[后端 ] SpringBoot + Nginx</li></ul><ol start="5"><li>将项目打包成jar<br>. <img src="https://img-blog.csdnimg.cn/20210310150849307.png" alt="在这里插入图片描述"></li><li>在根目录build文件中生成jar包<br><img src="https://img-blog.csdnimg.cn/20210310151115758.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NfQl9NX1o=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li><li>找到jar包目录 命令行窗口执行 java -jar XXX.jar –serverport=****</li></ol>]]></content>
      
      
      <categories>
          
          <category> SpringBoot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBoot中应用Quartz</title>
      <link href="/2021/11/04/SpringBoot%E4%B8%AD%E5%BA%94%E7%94%A8Quartz/"/>
      <url>/2021/11/04/SpringBoot%E4%B8%AD%E5%BA%94%E7%94%A8Quartz/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><ol><li>Quartz是OpenSymphony开源组织在Job scheduling领域又一个开源项目，它可以与J2EE与J2SE应用程序相结合也可以单独使用。Quartz可以用来创建简单或为运行十个，百个，甚至是好几万个Jobs这样复杂的程序。</li><li>我们在使用Quartz来创建定时任务是,只需要关注三点内容  : Job（任务），Trigger（触发器）和Scheduler（调度器）<pre><code> Job :  我们想要做的定时任务内容是什么。</code></pre>　　Trigger :  我们想在什么时间上执行job。<br>　　Scheduler :  触发器生效 , 进行定时任务。</li></ol><h1 id="在SpringBoot中应用Quartz"><a href="#在SpringBoot中应用Quartz" class="headerlink" title="在SpringBoot中应用Quartz"></a>在SpringBoot中应用Quartz</h1><ol><li>在pom.xml中添加依赖</li></ol><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- scheduled所属资源为spring-context-support，在Spring中对Quartz的支持，是集成在spring-context-support包中。org.springframework.scheduling.quartz --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context-support<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Quartz坐标 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.quartz-scheduler<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>quartz<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- Quartz默认需要slf4j支持。springboot中，提供了更高版本的slf4j --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Spring tx 坐标，quartz可以提供分布式定时任务环境。多个分布点上的Quartz任务，是通过数据库实现任务信息传递的.通过数据库中的数据，保证一个时间点上，只有一个分布环境执行定时任务--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-tx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2.在SpringBoot启动类使用@EnableScheduling注解  </p><p><img src="https://img-blog.csdnimg.cn/20201121102819185.png#pic_center" alt="在这里插入图片描述"><br>3. 编写自己的定时任务实现job<br><img src="https://img-blog.csdnimg.cn/20201121103126457.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NfQl9NX1o=,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>4. 编写定时任务配置类<br><img src="https://img-blog.csdnimg.cn/20201121103451164.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NfQl9NX1o=,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>5.重写JobFactory 实现将JobDetail对象加入到Spring容器中，让Spring容器管理，并自动装配逻辑。<br><img src="https://img-blog.csdnimg.cn/20201121104025746.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0NfQl9NX1o=,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>6. 启动 测试</p>]]></content>
      
      
      <categories>
          
          <category> SpringBoot </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hugo搭建个人博客(windows)</title>
      <link href="/2021/11/04/hugo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2(windows)/"/>
      <url>/2021/11/04/hugo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2(windows)/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="hugo搭建个人博客-windows"><a href="#hugo搭建个人博客-windows" class="headerlink" title="hugo搭建个人博客(windows)"></a>hugo搭建个人博客(windows)</h3><h4 id="1-下载Hugo安装包"><a href="#1-下载Hugo安装包" class="headerlink" title="1. 下载Hugo安装包"></a>1. 下载Hugo安装包</h4><p>​    1.1. 下载安装包直接解压得到 <code>hugo.exe</code></p><p><a href="https://github.com/gohugoio/hugo/releases">安装包下载</a>  建议直接下载<code>extended</code>版本的    </p><p>​    1.2. 配置环境变量    将 <code>hugo.exe</code>  路径配置到环境变量 path中</p><p>​    1.3.打开cmd窗口  执行<code>hugo version</code>  显示版本    表示安装正确</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20211103112702096.png" alt="image-20211103112702096"></p><h4 id="2-搭建个人博客"><a href="#2-搭建个人博客" class="headerlink" title="2. 搭建个人博客"></a>2. 搭建个人博客</h4><p>创建一个文件夹   作为保存自己网页的文件夹   进入文件夹   执行`hugo new site XXX(名字自己起)</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20211103113323148.png" alt="image-20211103113323148"></p><p>表示创建成功   你会在创建的文件夹下看到一个   XXX文件夹 (就是存放你博客站点文件)</p><p>其中config.toml是网站的配置文件，content文件夹放Markdown文档，data文件夹放数据，layouts文件夹放网站模板文件，static文件夹放图片、css、js 等静态资源，themes文件夹存放主题</p><p>进入到XXX文件夹 下面  执行<code>hugo server</code></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20211103114026477.png" alt="image-20211103114026477"></p><h4 id="3-修改博客主题"><a href="#3-修改博客主题" class="headerlink" title="3.修改博客主题"></a>3.修改博客主题</h4><h5 id="1-下载需要的主题"><a href="#1-下载需要的主题" class="headerlink" title="1. 下载需要的主题"></a>1. 下载需要的主题</h5><p><a href="https://themes.gohugo.io/">hugo主题下载</a></p><p>本人下载m10c</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20211103114814070.png" alt="image-20211103114814070"></p><p>进入到 themes目录</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20211103114904752.png" alt="image-20211103114904752"></p><p>执行 <code> git clone https://github.com/vaga/hugo-theme-m10c.git</code>  克隆主题</p><h5 id="2-修改主题"><a href="#2-修改主题" class="headerlink" title="2. 修改主题"></a>2. 修改主题</h5><p>在站点的主目录找到<code>config.toml</code>并编辑其中的theme参数，将其修改为下载的皮肤的名称（如果没有此行参数，请按下图添加），如<code>theme = &quot;hugo-theme-m10c&quot;</code>。</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20211103115337296.png" alt="image-20211103115337296"></p><h5 id="3-添加页面"><a href="#3-添加页面" class="headerlink" title="3.添加页面"></a>3.添加页面</h5><p>进入XXX目录  执行<code>hugo new post/pushu.md</code>     那么content\post文件加下有个文件  编辑文件</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20211103115720084.png" alt="image-20211103115720084"></p><p>然后再XXX目录下  执行<code>hugo server</code></p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20211103115841821.png" alt="image-20211103115841821"></p><p>访问<code>localhost:1313</code>  看到如下页面</p><p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20211103115940238.png" alt="image-20211103115940238"></p><p>表示本地博客搭建成功</p>]]></content>
      
      
      <categories>
          
          <category> hugo搭建博客 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hugo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javaWeb实现随机图片验证码</title>
      <link href="/2021/11/04/javaWeb%E5%AE%9E%E7%8E%B0%E9%9A%8F%E6%9C%BA%E5%9B%BE%E7%89%87%E9%AA%8C%E8%AF%81%E7%A0%81/"/>
      <url>/2021/11/04/javaWeb%E5%AE%9E%E7%8E%B0%E9%9A%8F%E6%9C%BA%E5%9B%BE%E7%89%87%E9%AA%8C%E8%AF%81%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="javaWeb实现随机图片验证码"><a href="#javaWeb实现随机图片验证码" class="headerlink" title="javaWeb实现随机图片验证码"></a>javaWeb实现随机图片验证码</h3><h4 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h4><pre><code>                1. 图片生成工具类                2. 使用工具类生成                3.校验图形验证码</code></pre><h4 id="图片生成工具类"><a href="#图片生成工具类" class="headerlink" title="图片生成工具类"></a>图片生成工具类</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RandomValidateCodeUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(RandomValidateCodeUtil.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//放到session中的key</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String RANDOMCODEKEY = <span class="string">&quot;RANDOMVALIDATECODEKEY&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//随机产生只有数字的字符串 private String</span></span><br><span class="line">    <span class="keyword">private</span> String randString = <span class="string">&quot;0123456789&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//随机产生只有字母的字符串</span></span><br><span class="line">    <span class="comment">//private String randString = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//随机产生数字与字母组合的字符串</span></span><br><span class="line">    <span class="comment">//private String randString = &quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 图片宽</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> width = <span class="number">95</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 图片高</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> height = <span class="number">25</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 干扰线数量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> lineSize = <span class="number">40</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 随机产生字符数量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> stringNum = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Random random = <span class="keyword">new</span> Random();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获得字体</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Font <span class="title">getFont</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Font(<span class="string">&quot;Fixedsys&quot;</span>, Font.CENTER_BASELINE, <span class="number">18</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获得颜色</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Color <span class="title">getRandColor</span><span class="params">(<span class="keyword">int</span> fc, <span class="keyword">int</span> bc)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (fc &gt; <span class="number">255</span>) &#123;</span><br><span class="line">            fc = <span class="number">255</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (bc &gt; <span class="number">255</span>) &#123;</span><br><span class="line">            bc = <span class="number">255</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> r = fc + random.nextInt(bc - fc - <span class="number">16</span>);</span><br><span class="line">        <span class="keyword">int</span> g = fc + random.nextInt(bc - fc - <span class="number">14</span>);</span><br><span class="line">        <span class="keyword">int</span> b = fc + random.nextInt(bc - fc - <span class="number">18</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Color(r, g, b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 生成随机图片</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getRandcode</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> </span>&#123;</span><br><span class="line">        Httpsession session = request.getSession();</span><br><span class="line">        <span class="comment">// BufferedImage类是具有缓冲区的Image类,Image类是用于描述图像信息的类</span></span><br><span class="line">        BufferedImage image = <span class="keyword">new</span> BufferedImage(width, height, BufferedImage.TYPE_INT_BGR);</span><br><span class="line">        <span class="comment">// 产生Image对象的Graphics对象,改对象可以在图像上进行各种绘制操作</span></span><br><span class="line">        Graphics g = image.getGraphics();</span><br><span class="line">        <span class="comment">//图片大小</span></span><br><span class="line">        g.fillRect(<span class="number">0</span>, <span class="number">0</span>, width, height);</span><br><span class="line">        <span class="comment">//字体大小</span></span><br><span class="line">        g.setFont(<span class="keyword">new</span> Font(<span class="string">&quot;Default&quot;</span>, Font.ROMAN_BASELINE, <span class="number">18</span>));</span><br><span class="line">        <span class="comment">//字体颜色</span></span><br><span class="line">        g.setColor(getRandColor(<span class="number">110</span>, <span class="number">133</span>));</span><br><span class="line">        <span class="comment">// 绘制干扰线</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= lineSize; i++) &#123;</span><br><span class="line">            drowLine(g);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 绘制随机字符</span></span><br><span class="line">        String randomString = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= stringNum; i++) &#123;</span><br><span class="line">            randomString = drowString(g, randomString, i);</span><br><span class="line">        &#125;</span><br><span class="line">        logger.info(randomString);</span><br><span class="line">        g.dispose();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 将内存中的图片通过流动形式输出到客户端</span></span><br><span class="line">            ImageIO.write(image, <span class="string">&quot;JPEG&quot;</span>, response.getOutputStream());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logger.info(<span class="string">&quot;将内存中的图片通过流动形式输出到客户端失败&gt;&gt;&gt;&gt; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> randomString;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 绘制字符串</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">drowString</span><span class="params">(Graphics g, String randomString, <span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        g.setFont(getFont());</span><br><span class="line">        g.setColor(<span class="keyword">new</span> Color(random.nextInt(<span class="number">101</span>), random.nextInt(<span class="number">111</span>), random</span><br><span class="line">                .nextInt(<span class="number">121</span>)));</span><br><span class="line">        String rand = String.valueOf(getRandomString(random.nextInt(randString</span><br><span class="line">                .length())));</span><br><span class="line">        randomString += rand;</span><br><span class="line">        g.translate(random.nextInt(<span class="number">3</span>), random.nextInt(<span class="number">3</span>));</span><br><span class="line">        g.drawString(rand, <span class="number">13</span> * i, <span class="number">16</span>);</span><br><span class="line">        <span class="keyword">return</span> randomString;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 绘制干扰线</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">drowLine</span><span class="params">(Graphics g)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x = random.nextInt(width);</span><br><span class="line">        <span class="keyword">int</span> y = random.nextInt(height);</span><br><span class="line">        <span class="keyword">int</span> xl = random.nextInt(<span class="number">13</span>);</span><br><span class="line">        <span class="keyword">int</span> yl = random.nextInt(<span class="number">15</span>);</span><br><span class="line">        g.drawLine(x, y, x + xl, y + yl);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取随机的字符</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getRandomString</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> String.valueOf(randString.charAt(num));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="使用工具类生成"><a href="#使用工具类生成" class="headerlink" title="使用工具类生成"></a>使用工具类生成</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping(value = &quot;/getVerify&quot;)</span></span><br><span class="line">   <span class="meta">@ApiOperation(&quot;生成图片验证码&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getVerify</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           <span class="comment">//设置相应类型,告诉浏览器输出的内容为图片</span></span><br><span class="line">           response.setContentType(<span class="string">&quot;image/jpeg&quot;</span>);</span><br><span class="line">           <span class="comment">//设置响应头信息，告诉浏览器不要缓存此内容</span></span><br><span class="line">           response.setHeader(<span class="string">&quot;Pragma&quot;</span>, <span class="string">&quot;No-cache&quot;</span>);</span><br><span class="line">           response.setHeader(<span class="string">&quot;Cache-Control&quot;</span>, <span class="string">&quot;no-cache&quot;</span>);</span><br><span class="line">           response.setDateHeader(<span class="string">&quot;Expire&quot;</span>, <span class="number">0</span>);</span><br><span class="line">           RandomValidateCodeUtil randomValidateCode = <span class="keyword">new</span> RandomValidateCodeUtil();</span><br><span class="line">           <span class="comment">//输出验证码图片方法</span></span><br><span class="line">           String randcode = randomValidateCode.getRandcode(request, response);</span><br><span class="line">           </span><br><span class="line">           <span class="comment">// 将随机生成的字符串放在redis中</span></span><br><span class="line">           redisUtil.save(<span class="string">&quot;random&quot;</span>, randcode);</span><br><span class="line">           </span><br><span class="line">           <span class="comment">// 将生成的随机字符串保存到session中</span></span><br><span class="line">           <span class="comment">// HttpSession session = request.getSession();</span></span><br><span class="line">           <span class="comment">// session.removeAttribute(RANDOMCODEKEY);</span></span><br><span class="line">           <span class="comment">// session.setAttribute(RANDOMCODEKEY, randomString);</span></span><br><span class="line"></span><br><span class="line">       &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">           log.error(<span class="string">&quot;获取验证码失败&gt;&gt;&gt;&gt; &quot;</span>, e);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h4 id="校验验证码"><a href="#校验验证码" class="headerlink" title="校验验证码"></a>校验验证码</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/checkVerify&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;校验图形验证码&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">checkValidateCode</span><span class="params">(String verify)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 校验验证码</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 从redis中获取验证码</span></span><br><span class="line">            String random = (String) redisUtil.findKey(<span class="string">&quot;random&quot;</span>);</span><br><span class="line"></span><br><span class="line">           <span class="comment">// 从ression中获取验证码</span></span><br><span class="line">           HttpSession session = request.getSession();</span><br><span class="line">            String random = session.getAttribute(<span class="string">&quot;random&quot;</span>);</span><br><span class="line"></span><br><span class="line">            log.info(<span class="string">&quot;获取的随机数 random = &#123;&#125;&quot;</span>, random);</span><br><span class="line">            <span class="keyword">if</span> (org.springframework.util.StringUtils.isEmpty(verify)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;没有输入验证码&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (verify.equals(random)) &#123;</span><br><span class="line">                redisUtil.delKey(<span class="string">&quot;random&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;验证码错误&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;验证码校验失败&quot;</span>, e);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;服务器异常&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;成功&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>验证：从redis或者seesion取出存入的验证码与用户输入的比对,相同验证成功，反之验证失败。</p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java后台生成验证码(二)</title>
      <link href="/2021/11/04/java%E5%90%8E%E5%8F%B0%E7%94%9F%E6%88%90%E9%AA%8C%E8%AF%81%E7%A0%81(%E4%BA%8C)/"/>
      <url>/2021/11/04/java%E5%90%8E%E5%8F%B0%E7%94%9F%E6%88%90%E9%AA%8C%E8%AF%81%E7%A0%81(%E4%BA%8C)/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h4 id="java后台生成验证码-二"><a href="#java后台生成验证码-二" class="headerlink" title="java后台生成验证码(二)"></a>java后台生成验证码(二)</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*验证码图片生成工具</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">import</span> java.awt.Color;</span><br><span class="line"><span class="keyword">import</span> java.awt.Font;</span><br><span class="line"><span class="keyword">import</span> java.awt.Graphics;</span><br><span class="line"><span class="keyword">import</span> java.awt.image.BufferedImage;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.imageio.ImageIO;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ValidCodeServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">7785319966330896339L</span>;</span><br><span class="line"><span class="comment">//设置字母的大小,大小   </span></span><br><span class="line">    <span class="keyword">private</span> Font mFont = <span class="keyword">new</span> Font(<span class="string">&quot;Times New Roman&quot;</span>, Font.PLAIN, <span class="number">20</span>);   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException   </span></span><br><span class="line"><span class="function">    </span>&#123;   </span><br><span class="line">        <span class="keyword">super</span>.init();   </span><br><span class="line">    &#125;   </span><br><span class="line">    <span class="function">Color <span class="title">getRandColor</span><span class="params">(<span class="keyword">int</span> fc,<span class="keyword">int</span> bc)</span>   </span></span><br><span class="line"><span class="function">    </span>&#123;   </span><br><span class="line">        Random random = <span class="keyword">new</span> Random();   </span><br><span class="line">        <span class="keyword">if</span>(fc&gt;<span class="number">255</span>) fc=<span class="number">255</span>;   </span><br><span class="line">        <span class="keyword">if</span>(bc&gt;<span class="number">255</span>) bc=<span class="number">255</span>;   </span><br><span class="line">        <span class="keyword">int</span> r=fc+random.nextInt(bc-fc);   </span><br><span class="line">        <span class="keyword">int</span> g=fc+random.nextInt(bc-fc);   </span><br><span class="line">        <span class="keyword">int</span> b=fc+random.nextInt(bc-fc);   </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Color(r,g,b);   </span><br><span class="line">    &#125;   </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException   </span></span><br><span class="line"><span class="function">    </span>&#123;   </span><br><span class="line">        response.setHeader(<span class="string">&quot;Pragma&quot;</span>,<span class="string">&quot;No-cache&quot;</span>);   </span><br><span class="line">        response.setHeader(<span class="string">&quot;Cache-Control&quot;</span>,<span class="string">&quot;no-cache&quot;</span>);   </span><br><span class="line">        response.setDateHeader(<span class="string">&quot;Expires&quot;</span>, <span class="number">0</span>);   </span><br><span class="line">        <span class="comment">//表明生成的响应是图片   </span></span><br><span class="line">        response.setContentType(<span class="string">&quot;image/jpeg&quot;</span>);   </span><br><span class="line">           </span><br><span class="line">        <span class="keyword">int</span> width=<span class="number">80</span>, height=<span class="number">18</span>;   </span><br><span class="line">        BufferedImage image = <span class="keyword">new</span> BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);   </span><br><span class="line">           </span><br><span class="line">        Graphics g = image.getGraphics();   </span><br><span class="line">        Random random = <span class="keyword">new</span> Random();   </span><br><span class="line">        g.setColor(getRandColor(<span class="number">200</span>,<span class="number">250</span>));   </span><br><span class="line">        g.fillRect(<span class="number">1</span>, <span class="number">1</span>, width-<span class="number">1</span>, height-<span class="number">1</span>);   </span><br><span class="line">        g.setColor(<span class="keyword">new</span> Color(<span class="number">102</span>,<span class="number">102</span>,<span class="number">102</span>));   </span><br><span class="line">        g.drawRect(<span class="number">0</span>, <span class="number">0</span>, width-<span class="number">1</span>, height-<span class="number">1</span>);   </span><br><span class="line">        g.setFont(mFont);   </span><br><span class="line">  </span><br><span class="line">        g.setColor(getRandColor(<span class="number">160</span>,<span class="number">200</span>));   </span><br><span class="line">  </span><br><span class="line">        <span class="comment">//画随机线   </span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">155</span>;i++)   </span><br><span class="line">        &#123;   </span><br><span class="line">            <span class="keyword">int</span> x = random.nextInt(width - <span class="number">1</span>);   </span><br><span class="line">            <span class="keyword">int</span> y = random.nextInt(height - <span class="number">1</span>);   </span><br><span class="line">            <span class="keyword">int</span> xl = random.nextInt(<span class="number">6</span>) + <span class="number">1</span>;   </span><br><span class="line">            <span class="keyword">int</span> yl = random.nextInt(<span class="number">12</span>) + <span class="number">1</span>;   </span><br><span class="line">            g.drawLine(x,y,x + xl,y + yl);   </span><br><span class="line">        &#125;   </span><br><span class="line">  </span><br><span class="line">        <span class="comment">//从另一方向画随机线   </span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">70</span>;i++)   </span><br><span class="line">        &#123;   </span><br><span class="line">            <span class="keyword">int</span> x = random.nextInt(width - <span class="number">1</span>);   </span><br><span class="line">            <span class="keyword">int</span> y = random.nextInt(height - <span class="number">1</span>);   </span><br><span class="line">            <span class="keyword">int</span> xl = random.nextInt(<span class="number">12</span>) + <span class="number">1</span>;   </span><br><span class="line">            <span class="keyword">int</span> yl = random.nextInt(<span class="number">6</span>) + <span class="number">1</span>;   </span><br><span class="line">            g.drawLine(x,y,x - xl,y - yl);   </span><br><span class="line">        &#125;   </span><br><span class="line">  </span><br><span class="line">        <span class="comment">//生成随机数,并将随机数字转换为字母   </span></span><br><span class="line">        String sRand=<span class="string">&quot;&quot;</span>;   </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)   </span><br><span class="line">        &#123;   </span><br><span class="line">            <span class="keyword">int</span> itmp = random.nextInt(<span class="number">26</span>) + <span class="number">65</span>;   </span><br><span class="line">            <span class="keyword">char</span> ctmp = (<span class="keyword">char</span>)itmp;   </span><br><span class="line">            sRand += String.valueOf(ctmp);   </span><br><span class="line">            g.setColor(<span class="keyword">new</span> Color(<span class="number">20</span>+random.nextInt(<span class="number">110</span>),<span class="number">20</span>+random.nextInt(<span class="number">110</span>),<span class="number">20</span>+random.nextInt(<span class="number">110</span>)));   </span><br><span class="line">            g.drawString(String.valueOf(ctmp),<span class="number">15</span>*i+<span class="number">10</span>,<span class="number">16</span>);   </span><br><span class="line">        &#125;   </span><br><span class="line">        HttpSession session = request.getSession(<span class="keyword">true</span>);   </span><br><span class="line">        System.out.println(sRand);</span><br><span class="line">        session.setAttribute(<span class="string">&quot;code&quot;</span>,sRand);   </span><br><span class="line">        g.dispose();   </span><br><span class="line">        ImageIO.write(image, <span class="string">&quot;JPEG&quot;</span>, response.getOutputStream());   </span><br><span class="line">    &#125;     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>读取图片位置信息</title>
      <link href="/2021/11/04/java%E8%AF%BB%E5%8F%96%E5%9B%BE%E7%89%87%E4%BD%8D%E7%BD%AE%E4%BF%A1%E6%81%AF/"/>
      <url>/2021/11/04/java%E8%AF%BB%E5%8F%96%E5%9B%BE%E7%89%87%E4%BD%8D%E7%BD%AE%E4%BF%A1%E6%81%AF/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h4 id="1-使用SpringBoot构建项目-导入依赖"><a href="#1-使用SpringBoot构建项目-导入依赖" class="headerlink" title="1 使用SpringBoot构建项目 导入依赖"></a>1 使用SpringBoot构建项目 导入依赖</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">           &lt;groupId&gt;com.drewnoakes&lt;/groupId&gt;</span><br><span class="line">           &lt;artifactId&gt;metadata-extractor&lt;/artifactId&gt;</span><br><span class="line">           &lt;version&gt;<span class="number">2.16</span><span class="number">.0</span>&lt;/version&gt;</span><br><span class="line">       &lt;/dependency&gt;</span><br><span class="line">       &lt;dependency&gt;</span><br><span class="line">           &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;</span><br><span class="line">           &lt;artifactId&gt;lombok&lt;/artifactId&gt;</span><br><span class="line">           &lt;version&gt;<span class="number">1.16</span><span class="number">.16</span>&lt;/version&gt;</span><br><span class="line">       &lt;/dependency&gt;</span><br><span class="line">       &lt;dependency&gt;</span><br><span class="line">           &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;</span><br><span class="line">           &lt;artifactId&gt;httpclient&lt;/artifactId&gt;</span><br><span class="line">           &lt;version&gt;<span class="number">4.5</span><span class="number">.12</span>&lt;/version&gt;</span><br><span class="line">       &lt;/dependency&gt;</span><br><span class="line">       &lt;dependency&gt;</span><br><span class="line">           &lt;groupId&gt;com.alibaba&lt;/groupId&gt;</span><br><span class="line">           &lt;artifactId&gt;fastjson&lt;/artifactId&gt;</span><br><span class="line">           &lt;version&gt;<span class="number">1.2</span><span class="number">.15</span>&lt;/version&gt;</span><br><span class="line">       &lt;/dependency&gt;</span><br><span class="line">       &lt;dependency&gt;</span><br><span class="line">           &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;</span><br><span class="line">           &lt;artifactId&gt;httpclient&lt;/artifactId&gt;</span><br><span class="line">           &lt;version&gt;<span class="number">4.2</span><span class="number">.1</span>&lt;/version&gt;</span><br><span class="line">       &lt;/dependency&gt;</span><br><span class="line">       &lt;dependency&gt;</span><br><span class="line">           &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;</span><br><span class="line">           &lt;artifactId&gt;httpcore&lt;/artifactId&gt;</span><br><span class="line">           &lt;version&gt;<span class="number">4.2</span><span class="number">.1</span>&lt;/version&gt;</span><br><span class="line">       &lt;/dependency&gt;</span><br><span class="line">       &lt;dependency&gt;</span><br><span class="line">           &lt;groupId&gt;commons-lang&lt;/groupId&gt;</span><br><span class="line">           &lt;artifactId&gt;commons-lang&lt;/artifactId&gt;</span><br><span class="line">           &lt;version&gt;<span class="number">2.6</span>&lt;/version&gt;</span><br><span class="line">       &lt;/dependency&gt;</span><br><span class="line">       &lt;dependency&gt;</span><br><span class="line">           &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;</span><br><span class="line">           &lt;artifactId&gt;jetty-util&lt;/artifactId&gt;</span><br><span class="line">           &lt;version&gt;<span class="number">9.3</span><span class="number">.7</span>.v20160115&lt;/version&gt;</span><br><span class="line">       &lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h4 id="2-编写代码"><a href="#2-编写代码" class="headerlink" title="2 编写代码"></a>2 编写代码</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.pushu.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.drew.imaging.ImageMetadataReader;</span><br><span class="line"><span class="keyword">import</span> com.drew.metadata.Directory;</span><br><span class="line"><span class="keyword">import</span> com.drew.metadata.Metadata;</span><br><span class="line"><span class="keyword">import</span> com.drew.metadata.Tag;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.net.URLConnection;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ImgTestCode</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        File file = <span class="keyword">new</span> File(<span class="string">&quot;E:\\Pictures\\2020-10\\IMG_20201009_195155.jpg&quot;</span>);</span><br><span class="line">        readImageInfo(file);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">readImageInfo</span><span class="params">(File file)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Metadata metadata = ImageMetadataReader.readMetadata(file);</span><br><span class="line">        System.out.println(<span class="string">&quot;=========打印全部信息=========&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (Directory directory : metadata.getDirectories()) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Tag tag : directory.getTags()) &#123;</span><br><span class="line">                System.out.format(<span class="string">&quot;[%s]-%s=%s\n&quot;</span>,</span><br><span class="line">                        directory.getName(),</span><br><span class="line">                        tag.getTagName(),</span><br><span class="line">                        tag.getDescription());</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(directory.hasErrors())&#123;</span><br><span class="line">                <span class="keyword">for</span> (String error : directory.getErrors()) &#123;</span><br><span class="line">                    System.err.format(<span class="string">&quot;Error: %s&quot;</span>,error);</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;==========打印常用信息===========&quot;</span>);</span><br><span class="line">        Double lat = <span class="keyword">null</span>;</span><br><span class="line">        Double lon = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">for</span> (Directory directory : metadata.getDirectories()) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Tag tag : directory.getTags()) &#123;</span><br><span class="line">                String tagName = tag.getTagName();</span><br><span class="line">                String desc = tag.getDescription();</span><br><span class="line">                <span class="keyword">if</span>(tagName.equals(<span class="string">&quot;Image Height&quot;</span>))&#123;</span><br><span class="line">                    System.err.println(<span class="string">&quot;图片高度:&quot;</span>+desc);</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span> (tagName.equals(<span class="string">&quot;Image Width&quot;</span>)) &#123;</span><br><span class="line">                    System.err.println(<span class="string">&quot;图片宽度: &quot;</span> + desc);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tagName.equals(<span class="string">&quot;Date/Time Original&quot;</span>)) &#123;</span><br><span class="line">                    System.err.println(<span class="string">&quot;拍摄时间: &quot;</span> + desc);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tagName.equals(<span class="string">&quot;GPS Latitude&quot;</span>)) &#123;</span><br><span class="line">                    System.err.println(<span class="string">&quot;纬度 : &quot;</span> + desc);</span><br><span class="line">                    System.err.println(<span class="string">&quot;纬度(度分秒格式) : &quot;</span> + pointToLatlong(desc));</span><br><span class="line">                    lat = latLng2Decimal(desc);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tagName.equals(<span class="string">&quot;GPS Longitude&quot;</span>)) &#123;</span><br><span class="line">                    System.err.println(<span class="string">&quot;经度: &quot;</span> + desc);</span><br><span class="line">                    System.err.println(<span class="string">&quot;经度(度分秒格式): &quot;</span> + pointToLatlong(desc));</span><br><span class="line">                    lon = latLng2Decimal(desc);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        System.err.println(<span class="string">&quot;===经纬度转地址=======&quot;</span>);</span><br><span class="line">        convertGpsToLoaction(lat,lon);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * api_key：注册的百度api的key</span></span><br><span class="line"><span class="comment">     * coords：经纬度坐标</span></span><br><span class="line"><span class="comment">     * http://api.map.baidu.com/reverse_geocoding/v3/?ak=&quot;+api_key+&quot;&amp;output=json&amp;coordtype=wgs84ll&amp;location=&quot;+coords</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 经纬度转地址信息</span></span><br><span class="line"><span class="comment">     *&lt;/p&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> gps_latitude  维度</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> gps_longitude 精度</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">convertGpsToLoaction</span><span class="params">(<span class="keyword">double</span> gps_latitude, <span class="keyword">double</span> gps_longitude)</span><span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String apiKey = <span class="string">&quot;xxxxxxxxxx&quot;</span>;</span><br><span class="line">        String res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        String url = <span class="string">&quot;http://api.map.baidu.com/reverse_geocoding/v3/?ak=&quot;</span> + apiKey + <span class="string">&quot;&amp;output=json&amp;coordtype=wgs84ll&amp;location=&quot;</span> + (gps_latitude + <span class="string">&quot;,&quot;</span> + gps_longitude);</span><br><span class="line">        StringBuilder json = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        System.out.println(url);</span><br><span class="line">        URL getUrl = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            getUrl = <span class="keyword">new</span> URL(url);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (MalformedURLException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        URLConnection link = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            link = getUrl.openConnection();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        InputStreamReader io = <span class="keyword">new</span> InputStreamReader(link.getInputStream(),<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        BufferedReader bufferedReader = <span class="keyword">new</span> BufferedReader(io);</span><br><span class="line">        String in = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">while</span> ((in=bufferedReader.readLine())!= <span class="keyword">null</span>) &#123;</span><br><span class="line">            json.append(in);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(json);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * 经纬度坐标格式转换（* °转十进制格式）</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> gps</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Double <span class="title">latLng2Decimal</span><span class="params">(String gps)</span> </span>&#123;</span><br><span class="line">        String a = gps.split(<span class="string">&quot;°&quot;</span>)[<span class="number">0</span>].replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">        String b = gps.split(<span class="string">&quot;°&quot;</span>)[<span class="number">1</span>].split(<span class="string">&quot;&#x27;&quot;</span>)[<span class="number">0</span>].replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">        String c = gps.split(<span class="string">&quot;°&quot;</span>)[<span class="number">1</span>].split(<span class="string">&quot;&#x27;&quot;</span>)[<span class="number">1</span>].replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;\&quot;&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="keyword">double</span> gps_dou = Double.parseDouble(a) + Double.parseDouble(b) / <span class="number">60</span> + Double.parseDouble(c) / <span class="number">60</span> / <span class="number">60</span>;</span><br><span class="line">        <span class="keyword">return</span> gps_dou;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 经纬度格式  转换为  度分秒格式 ,如果需要的话可以调用该方法进行转换</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> point 坐标点</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">pointToLatlong</span><span class="params">(String point)</span> </span>&#123;</span><br><span class="line">        Double du = Double.parseDouble(point.substring(<span class="number">0</span>, point.indexOf(<span class="string">&quot;°&quot;</span>)).trim());</span><br><span class="line">        Double fen = Double.parseDouble(point.substring(point.indexOf(<span class="string">&quot;°&quot;</span>) + <span class="number">1</span>, point.indexOf(<span class="string">&quot;&#x27;&quot;</span>)).trim());</span><br><span class="line">        Double miao = Double.parseDouble(point.substring(point.indexOf(<span class="string">&quot;&#x27;&quot;</span>) + <span class="number">1</span>, point.indexOf(<span class="string">&quot;\&quot;&quot;</span>)).trim());</span><br><span class="line">        Double duStr = du + fen / <span class="number">60</span> + miao / <span class="number">60</span> / <span class="number">60</span>;</span><br><span class="line">        <span class="keyword">return</span> duStr.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><font coler = red><strong>注意</strong>:</font> 图片信息本身就必须有经纬度信息 , 否则转换出现异常,无法定位</p><h4 id="3-最终打印结果"><a href="#3-最终打印结果" class="headerlink" title="3 最终打印结果"></a>3 最终打印结果</h4><p>照片详细信息</p><p><img src="C:\Users\lenovo\Desktop\Snipaste_2021-11-05_17-23-05.png" alt="Snipaste_2021-11-05_17-23-05"></p><p>转换后信息</p><p><img src="C:\Users\lenovo\Desktop\Snipaste_2021-11-05_17-23-43.png" alt="Snipaste_2021-11-05_17-23-43"></p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>将java项目jar包设为开机自启项目</title>
      <link href="/2021/11/04/%E5%B0%86java%E9%A1%B9%E7%9B%AEjar%E5%8C%85%E8%AE%BE%E4%B8%BA%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF%E9%A1%B9%E7%9B%AE/"/>
      <url>/2021/11/04/%E5%B0%86java%E9%A1%B9%E7%9B%AEjar%E5%8C%85%E8%AE%BE%E4%B8%BA%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF%E9%A1%B9%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="Windows-系统下"><a href="#Windows-系统下" class="headerlink" title="Windows 系统下"></a>Windows 系统下</h3><ol><li>新建一个文本文件 , 将 <code>java -jar D:\workspace\xxx\libs\xxx.jar</code>写在其中 , 修改后缀名为XXX.bat</li><li>新建文本文件xxx.text  将下面的内容拷入, 修改文件后缀名为XXX.vbs</li></ol><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Set ws = CreateObject(“Wscript.Shell”)</span><br><span class="line">ws.run “cmd /c D:\workspace\xxx\libs\XXX.bat”,vbhide</span><br></pre></td></tr></table></figure><ol start="3"><li>将vbs文件创建快捷方式 , 放在开机自启目录下<br> <code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup</code></li><li>重新启动</li></ol><h3 id="linux系统下"><a href="#linux系统下" class="headerlink" title="linux系统下"></a>linux系统下</h3>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>日期工具类(一)</title>
      <link href="/2021/11/04/%E6%97%A5%E6%9C%9F%E5%B7%A5%E5%85%B7%E7%B1%BB/"/>
      <url>/2021/11/04/%E6%97%A5%E6%9C%9F%E5%B7%A5%E5%85%B7%E7%B1%BB/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.trgis.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.DateFormat;</span><br><span class="line"><span class="keyword">import</span> java.text.ParseException;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>   2017年4月28日上午10:37:07</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>  日期工具类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TimeUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 默认日期格式</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DATE_DEFAULT_FORMAT = <span class="string">&quot;yyyy-MM-dd&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 默认时间格式</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DATETIME_DEFAULT_FORMAT = <span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 默认时间格式不带秒</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DATETIME_WITHOUT_SECOND = <span class="string">&quot;yyyy-MM-dd HH:mm&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TIME_DEFAULT_FORMAT = <span class="string">&quot;HH:mm:ss&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String HOUR_MINUTE_DEFAULT_FORMAT = <span class="string">&quot;HH:mm&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">// 日期格式化</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> DateFormat dateFormat = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 时间格式化</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> DateFormat dateTimeFormat = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> DateFormat timeFormat = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Calendar gregorianCalendar = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        dateFormat = <span class="keyword">new</span> SimpleDateFormat(DATE_DEFAULT_FORMAT);</span><br><span class="line">        dateTimeFormat = <span class="keyword">new</span> SimpleDateFormat(DATETIME_DEFAULT_FORMAT);</span><br><span class="line">        timeFormat = <span class="keyword">new</span> SimpleDateFormat(TIME_DEFAULT_FORMAT);</span><br><span class="line">        gregorianCalendar = <span class="keyword">new</span> GregorianCalendar();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 日期格式化yyyy-MM-dd</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">formatDate</span><span class="params">(String date, String format)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> SimpleDateFormat(format).parse(date);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 日期格式化yyyy-MM-dd HH:mm</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">formatDateTimeWithoutSecond</span><span class="params">(String date)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> SimpleDateFormat(DATETIME_WITHOUT_SECOND).parse(date);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 日期格式化yyyy-MM-dd</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getDateFormat</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dateFormat.format(date);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 日期格式化yyyy-MM-dd HH:mm:ss</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getDateTimeFormat</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dateTimeFormat.format(date);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 日期格式化HH:mm</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getHMTimeFormat</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dateTimeFormat.format(date);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 时间格式化</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> HH:mm:ss</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getTimeFormat</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> timeFormat.format(date);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span>:或者当前时间的15*n分钟 HH:mm格式的时间</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@date</span> 2018年5月15日</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@ReturnType</span> String</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getTimeBeforeNMinute</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">      <span class="keyword">int</span> m = n*<span class="number">15</span>;</span><br><span class="line">      Calendar c = Calendar.getInstance(); </span><br><span class="line">      c.add(Calendar.MINUTE, -m);</span><br><span class="line">      SimpleDateFormat formatter = <span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;HH:mm&quot;</span>);</span><br><span class="line">      String mDateTime=formatter.format(c.getTime());</span><br><span class="line">      <span class="keyword">return</span> mDateTime;</span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 日期格式化</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getDateFormat</span><span class="params">(Date date, String formatStr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(formatStr)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> SimpleDateFormat(formatStr).format(date);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 日期格式化</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getDateFormat</span><span class="params">(String date)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> dateFormat.parse(date);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 时间格式化</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getDateTimeFormat</span><span class="params">(String date)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> dateTimeFormat.parse(date);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当前日期(yyyy-MM-dd)</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getNowDate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> TimeUtils.getDateFormat(dateFormat.format(<span class="keyword">new</span> Date()));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当前日期星期一日期</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> date</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getFirstDayOfWeek</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setFirstDayOfWeek(Calendar.MONDAY);</span><br><span class="line">        gregorianCalendar.setTime(<span class="keyword">new</span> Date());</span><br><span class="line">        gregorianCalendar.set(Calendar.DAY_OF_WEEK, gregorianCalendar.getFirstDayOfWeek()); <span class="comment">// Monday</span></span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当前日期星期日日期</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> date</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getLastDayOfWeek</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setFirstDayOfWeek(Calendar.MONDAY);</span><br><span class="line">        gregorianCalendar.setTime(<span class="keyword">new</span> Date());</span><br><span class="line">        gregorianCalendar.set(Calendar.DAY_OF_WEEK, gregorianCalendar.getFirstDayOfWeek() + <span class="number">6</span>); <span class="comment">// Monday</span></span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取日期星期一日期</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> date</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getFirstDayOfWeek</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (date == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        gregorianCalendar.setFirstDayOfWeek(Calendar.MONDAY);</span><br><span class="line">        gregorianCalendar.setTime(date);</span><br><span class="line">        gregorianCalendar.set(Calendar.DAY_OF_WEEK, gregorianCalendar.getFirstDayOfWeek()); <span class="comment">// Monday</span></span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取日期星期一日期</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> date</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getLastDayOfWeek</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (date == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        gregorianCalendar.setFirstDayOfWeek(Calendar.MONDAY);</span><br><span class="line">        gregorianCalendar.setTime(date);</span><br><span class="line">        gregorianCalendar.set(Calendar.DAY_OF_WEEK, gregorianCalendar.getFirstDayOfWeek() + <span class="number">6</span>); <span class="comment">// Monday</span></span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当前月的第一天</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> date</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getFirstDayOfMonth</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setTime(<span class="keyword">new</span> Date());</span><br><span class="line">        gregorianCalendar.set(Calendar.DAY_OF_MONTH, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当前月的最后一天</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getLastDayOfMonth</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setTime(<span class="keyword">new</span> Date());</span><br><span class="line">        gregorianCalendar.set(Calendar.DAY_OF_MONTH, <span class="number">1</span>);</span><br><span class="line">        gregorianCalendar.add(Calendar.MONTH, <span class="number">1</span>);</span><br><span class="line">        gregorianCalendar.add(Calendar.DAY_OF_MONTH, -<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取指定月的第一天</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getFirstDayOfMonth</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setTime(date);</span><br><span class="line">        gregorianCalendar.set(Calendar.DAY_OF_MONTH, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取指定月的最后一天</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getLastDayOfMonth</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setTime(date);</span><br><span class="line">        gregorianCalendar.set(Calendar.DAY_OF_MONTH, <span class="number">1</span>);</span><br><span class="line">        gregorianCalendar.add(Calendar.MONTH, <span class="number">1</span>);</span><br><span class="line">        gregorianCalendar.add(Calendar.DAY_OF_MONTH, -<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取日期前一天</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getDayBefore</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setTime(date);</span><br><span class="line">        <span class="keyword">int</span> day = gregorianCalendar.get(Calendar.DATE);</span><br><span class="line">        gregorianCalendar.set(Calendar.DATE, day - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取日期前n天</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getDayNDayBefore</span><span class="params">(Date date,<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setTime(date);</span><br><span class="line">        <span class="keyword">int</span> day = gregorianCalendar.get(Calendar.DATE);</span><br><span class="line">        gregorianCalendar.set(Calendar.DATE, day - n);</span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取日期后n天</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getDayNDayAfter</span><span class="params">(Date date,<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setTime(date);</span><br><span class="line">        <span class="keyword">int</span> day = gregorianCalendar.get(Calendar.DATE);</span><br><span class="line">        gregorianCalendar.set(Calendar.DATE, day + n);</span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取日期前n月</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getDayNMonthBefore</span><span class="params">(Date date,<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setTime(date);</span><br><span class="line">        <span class="keyword">int</span> month = gregorianCalendar.get(Calendar.MONTH);</span><br><span class="line">        gregorianCalendar.set(Calendar.MONTH, month - n);</span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当前日期以及前6天的日期</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Date&gt; <span class="title">getDayAndBefore6Day</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">    List&lt;Date&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">6</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">    list.add(getDayNDayBefore(date,i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取日期后一天</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getDayAfter</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setTime(date);</span><br><span class="line">        <span class="keyword">int</span> day = gregorianCalendar.get(Calendar.DATE);</span><br><span class="line">        gregorianCalendar.set(Calendar.DATE, day + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当前年</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getNowYear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Calendar d = Calendar.getInstance();</span><br><span class="line">        <span class="keyword">return</span> d.get(Calendar.YEAR);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当前月份</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getNowMonth</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Calendar d = Calendar.getInstance();</span><br><span class="line">        <span class="keyword">return</span> d.get(Calendar.MONTH) + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当月天数</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getNowMonthDay</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Calendar d = Calendar.getInstance();</span><br><span class="line">        <span class="keyword">return</span> d.getActualMaximum(Calendar.DATE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取时间段的每一天</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 日期列表</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Date&gt; <span class="title">getEveryDay</span><span class="params">(Date startDate, Date endDate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (startDate == <span class="keyword">null</span> || endDate == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 格式化日期(yy-MM-dd)</span></span><br><span class="line">        startDate = TimeUtils.getDateFormat(TimeUtils.getDateFormat(startDate));</span><br><span class="line">        endDate = TimeUtils.getDateFormat(TimeUtils.getDateFormat(endDate));</span><br><span class="line">        List&lt;Date&gt; dates = <span class="keyword">new</span> ArrayList&lt;Date&gt;();</span><br><span class="line">        gregorianCalendar.setTime(startDate);</span><br><span class="line">        dates.add(gregorianCalendar.getTime());</span><br><span class="line">        <span class="keyword">while</span> (gregorianCalendar.getTime().compareTo(endDate) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// 加1天</span></span><br><span class="line">            gregorianCalendar.add(Calendar.DAY_OF_MONTH, <span class="number">1</span>);</span><br><span class="line">            dates.add(gregorianCalendar.getTime());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dates;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取提前多少个月</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> monty</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getFirstMonth</span><span class="params">(<span class="keyword">int</span> monty)</span> </span>&#123;</span><br><span class="line">        Calendar c = Calendar.getInstance();</span><br><span class="line">        c.add(Calendar.MONTH, -monty);</span><br><span class="line">        <span class="keyword">return</span> c.getTime();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * App时间显示</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getTimeSlot</span><span class="params">(Date eDate)</span></span>&#123;</span><br><span class="line">    Calendar c = Calendar.getInstance();</span><br><span class="line">    <span class="keyword">if</span>(c.getTimeInMillis()-eDate.getTime()&lt;<span class="number">60000</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;刚刚&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(c.getTimeInMillis()-eDate.getTime()&lt;<span class="number">3600000</span>)&#123;</span><br><span class="line">    <span class="keyword">long</span> minitues =  Math.abs( c.getTimeInMillis() - eDate.getTime()) / (<span class="number">60</span> * <span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">return</span> minitues+<span class="string">&quot;分钟前&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>((c.getTimeInMillis()-eDate.getTime())&lt;<span class="number">3600000</span>*<span class="number">24</span>)&#123;</span><br><span class="line">    <span class="keyword">long</span> hours =  Math.abs( c.getTimeInMillis() - eDate.getTime()) / (<span class="number">60</span>*<span class="number">60</span> * <span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">return</span> hours+<span class="string">&quot;小时前&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>((c.getTimeInMillis()-eDate.getTime())&lt;<span class="number">3600000</span>*<span class="number">24</span>*<span class="number">7</span>)&#123;</span><br><span class="line">    <span class="keyword">long</span> days =  Math.abs( c.getTimeInMillis() - eDate.getTime()) / (<span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span> * <span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">return</span> days+<span class="string">&quot;天前&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getDateFormat(eDate);</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取日期前n分钟</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getNMinutesBefore</span><span class="params">(Date date,<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setTime(date);</span><br><span class="line">        <span class="keyword">int</span> minute = gregorianCalendar.get(Calendar.MINUTE);</span><br><span class="line">        gregorianCalendar.set(Calendar.MINUTE, minute - n);</span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当年的第一天</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getCurrYearFirst</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Calendar currCal=Calendar.getInstance();  </span><br><span class="line">        <span class="keyword">int</span> currentYear = currCal.get(Calendar.YEAR);</span><br><span class="line">        <span class="keyword">return</span> getYearFirst(currentYear);</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当年的最后一天</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getCurrYearLast</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Calendar currCal=Calendar.getInstance();  </span><br><span class="line">        <span class="keyword">int</span> currentYear = currCal.get(Calendar.YEAR);</span><br><span class="line">        <span class="keyword">return</span> getYearLast(currentYear);</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取某年第一天日期</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> year 骞翠唤</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Date</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getYearFirst</span><span class="params">(<span class="keyword">int</span> year)</span></span>&#123;</span><br><span class="line">        Calendar calendar = Calendar.getInstance();</span><br><span class="line">        calendar.clear();</span><br><span class="line">        calendar.set(Calendar.YEAR, year);</span><br><span class="line">        Date currYearFirst = calendar.getTime();</span><br><span class="line">        <span class="keyword">return</span> currYearFirst;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取某年最后一天日期</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> year 骞翠唤</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Date</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getYearLast</span><span class="params">(<span class="keyword">int</span> year)</span></span>&#123;</span><br><span class="line">        Calendar calendar = Calendar.getInstance();</span><br><span class="line">        calendar.clear();</span><br><span class="line">        calendar.set(Calendar.YEAR, year);</span><br><span class="line">        calendar.roll(Calendar.DAY_OF_YEAR, -<span class="number">1</span>);</span><br><span class="line">        Date currYearLast = calendar.getTime();</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">return</span> currYearLast;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> TimeUtils </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>日期工具类(二)</title>
      <link href="/2021/11/04/%E6%97%A5%E6%9C%9F%E5%B7%A5%E5%85%B7%E7%B1%BB%E4%BA%8C/"/>
      <url>/2021/11/04/%E6%97%A5%E6%9C%9F%E5%B7%A5%E5%85%B7%E7%B1%BB%E4%BA%8C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.trgis.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.DateFormat;</span><br><span class="line"><span class="keyword">import</span> java.text.ParseException;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>   2017年4月28日上午10:37:07</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>  日期工具类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TimeUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 默认日期格式</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DATE_DEFAULT_FORMAT = <span class="string">&quot;yyyy-MM-dd&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 默认时间格式</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DATETIME_DEFAULT_FORMAT = <span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 默认时间格式不带秒</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DATETIME_WITHOUT_SECOND = <span class="string">&quot;yyyy-MM-dd HH:mm&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TIME_DEFAULT_FORMAT = <span class="string">&quot;HH:mm:ss&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String HOUR_MINUTE_DEFAULT_FORMAT = <span class="string">&quot;HH:mm&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">// 日期格式化</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> DateFormat dateFormat = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 时间格式化</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> DateFormat dateTimeFormat = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> DateFormat timeFormat = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Calendar gregorianCalendar = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        dateFormat = <span class="keyword">new</span> SimpleDateFormat(DATE_DEFAULT_FORMAT);</span><br><span class="line">        dateTimeFormat = <span class="keyword">new</span> SimpleDateFormat(DATETIME_DEFAULT_FORMAT);</span><br><span class="line">        timeFormat = <span class="keyword">new</span> SimpleDateFormat(TIME_DEFAULT_FORMAT);</span><br><span class="line">        gregorianCalendar = <span class="keyword">new</span> GregorianCalendar();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 日期格式化yyyy-MM-dd</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">formatDate</span><span class="params">(String date, String format)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> SimpleDateFormat(format).parse(date);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 日期格式化yyyy-MM-dd HH:mm</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">formatDateTimeWithoutSecond</span><span class="params">(String date)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> SimpleDateFormat(DATETIME_WITHOUT_SECOND).parse(date);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 日期格式化yyyy-MM-dd</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getDateFormat</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dateFormat.format(date);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 日期格式化yyyy-MM-dd HH:mm:ss</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getDateTimeFormat</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dateTimeFormat.format(date);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 日期格式化HH:mm</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getHMTimeFormat</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dateTimeFormat.format(date);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 时间格式化</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> HH:mm:ss</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getTimeFormat</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> timeFormat.format(date);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span>:或者当前时间的15*n分钟 HH:mm格式的时间</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@date</span> 2018年5月15日</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@ReturnType</span> String</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getTimeBeforeNMinute</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">      <span class="keyword">int</span> m = n*<span class="number">15</span>;</span><br><span class="line">      Calendar c = Calendar.getInstance(); </span><br><span class="line">      c.add(Calendar.MINUTE, -m);</span><br><span class="line">      SimpleDateFormat formatter = <span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;HH:mm&quot;</span>);</span><br><span class="line">      String mDateTime=formatter.format(c.getTime());</span><br><span class="line">      <span class="keyword">return</span> mDateTime;</span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 日期格式化</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getDateFormat</span><span class="params">(Date date, String formatStr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(formatStr)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> SimpleDateFormat(formatStr).format(date);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 日期格式化</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getDateFormat</span><span class="params">(String date)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> dateFormat.parse(date);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 时间格式化</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getDateTimeFormat</span><span class="params">(String date)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> dateTimeFormat.parse(date);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当前日期(yyyy-MM-dd)</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getNowDate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> TimeUtils.getDateFormat(dateFormat.format(<span class="keyword">new</span> Date()));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当前日期星期一日期</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> date</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getFirstDayOfWeek</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setFirstDayOfWeek(Calendar.MONDAY);</span><br><span class="line">        gregorianCalendar.setTime(<span class="keyword">new</span> Date());</span><br><span class="line">        gregorianCalendar.set(Calendar.DAY_OF_WEEK, gregorianCalendar.getFirstDayOfWeek()); <span class="comment">// Monday</span></span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当前日期星期日日期</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> date</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getLastDayOfWeek</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setFirstDayOfWeek(Calendar.MONDAY);</span><br><span class="line">        gregorianCalendar.setTime(<span class="keyword">new</span> Date());</span><br><span class="line">        gregorianCalendar.set(Calendar.DAY_OF_WEEK, gregorianCalendar.getFirstDayOfWeek() + <span class="number">6</span>); <span class="comment">// Monday</span></span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取日期星期一日期</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> date</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getFirstDayOfWeek</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (date == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        gregorianCalendar.setFirstDayOfWeek(Calendar.MONDAY);</span><br><span class="line">        gregorianCalendar.setTime(date);</span><br><span class="line">        gregorianCalendar.set(Calendar.DAY_OF_WEEK, gregorianCalendar.getFirstDayOfWeek()); <span class="comment">// Monday</span></span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取日期星期一日期</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> date</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getLastDayOfWeek</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (date == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        gregorianCalendar.setFirstDayOfWeek(Calendar.MONDAY);</span><br><span class="line">        gregorianCalendar.setTime(date);</span><br><span class="line">        gregorianCalendar.set(Calendar.DAY_OF_WEEK, gregorianCalendar.getFirstDayOfWeek() + <span class="number">6</span>); <span class="comment">// Monday</span></span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当前月的第一天</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> date</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getFirstDayOfMonth</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setTime(<span class="keyword">new</span> Date());</span><br><span class="line">        gregorianCalendar.set(Calendar.DAY_OF_MONTH, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当前月的最后一天</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getLastDayOfMonth</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setTime(<span class="keyword">new</span> Date());</span><br><span class="line">        gregorianCalendar.set(Calendar.DAY_OF_MONTH, <span class="number">1</span>);</span><br><span class="line">        gregorianCalendar.add(Calendar.MONTH, <span class="number">1</span>);</span><br><span class="line">        gregorianCalendar.add(Calendar.DAY_OF_MONTH, -<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取指定月的第一天</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getFirstDayOfMonth</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setTime(date);</span><br><span class="line">        gregorianCalendar.set(Calendar.DAY_OF_MONTH, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取指定月的最后一天</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getLastDayOfMonth</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setTime(date);</span><br><span class="line">        gregorianCalendar.set(Calendar.DAY_OF_MONTH, <span class="number">1</span>);</span><br><span class="line">        gregorianCalendar.add(Calendar.MONTH, <span class="number">1</span>);</span><br><span class="line">        gregorianCalendar.add(Calendar.DAY_OF_MONTH, -<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取日期前一天</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getDayBefore</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setTime(date);</span><br><span class="line">        <span class="keyword">int</span> day = gregorianCalendar.get(Calendar.DATE);</span><br><span class="line">        gregorianCalendar.set(Calendar.DATE, day - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取日期前n天</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getDayNDayBefore</span><span class="params">(Date date,<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setTime(date);</span><br><span class="line">        <span class="keyword">int</span> day = gregorianCalendar.get(Calendar.DATE);</span><br><span class="line">        gregorianCalendar.set(Calendar.DATE, day - n);</span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取日期后n天</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getDayNDayAfter</span><span class="params">(Date date,<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setTime(date);</span><br><span class="line">        <span class="keyword">int</span> day = gregorianCalendar.get(Calendar.DATE);</span><br><span class="line">        gregorianCalendar.set(Calendar.DATE, day + n);</span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取日期前n月</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getDayNMonthBefore</span><span class="params">(Date date,<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setTime(date);</span><br><span class="line">        <span class="keyword">int</span> month = gregorianCalendar.get(Calendar.MONTH);</span><br><span class="line">        gregorianCalendar.set(Calendar.MONTH, month - n);</span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当前日期以及前6天的日期</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Date&gt; <span class="title">getDayAndBefore6Day</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">    List&lt;Date&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">6</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">    list.add(getDayNDayBefore(date,i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取日期后一天</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getDayAfter</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setTime(date);</span><br><span class="line">        <span class="keyword">int</span> day = gregorianCalendar.get(Calendar.DATE);</span><br><span class="line">        gregorianCalendar.set(Calendar.DATE, day + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当前年</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getNowYear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Calendar d = Calendar.getInstance();</span><br><span class="line">        <span class="keyword">return</span> d.get(Calendar.YEAR);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当前月份</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getNowMonth</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Calendar d = Calendar.getInstance();</span><br><span class="line">        <span class="keyword">return</span> d.get(Calendar.MONTH) + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当月天数</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getNowMonthDay</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Calendar d = Calendar.getInstance();</span><br><span class="line">        <span class="keyword">return</span> d.getActualMaximum(Calendar.DATE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取时间段的每一天</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 日期列表</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Date&gt; <span class="title">getEveryDay</span><span class="params">(Date startDate, Date endDate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (startDate == <span class="keyword">null</span> || endDate == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 格式化日期(yy-MM-dd)</span></span><br><span class="line">        startDate = TimeUtils.getDateFormat(TimeUtils.getDateFormat(startDate));</span><br><span class="line">        endDate = TimeUtils.getDateFormat(TimeUtils.getDateFormat(endDate));</span><br><span class="line">        List&lt;Date&gt; dates = <span class="keyword">new</span> ArrayList&lt;Date&gt;();</span><br><span class="line">        gregorianCalendar.setTime(startDate);</span><br><span class="line">        dates.add(gregorianCalendar.getTime());</span><br><span class="line">        <span class="keyword">while</span> (gregorianCalendar.getTime().compareTo(endDate) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// 加1天</span></span><br><span class="line">            gregorianCalendar.add(Calendar.DAY_OF_MONTH, <span class="number">1</span>);</span><br><span class="line">            dates.add(gregorianCalendar.getTime());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dates;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取提前多少个月</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> monty</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getFirstMonth</span><span class="params">(<span class="keyword">int</span> monty)</span> </span>&#123;</span><br><span class="line">        Calendar c = Calendar.getInstance();</span><br><span class="line">        c.add(Calendar.MONTH, -monty);</span><br><span class="line">        <span class="keyword">return</span> c.getTime();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * App时间显示</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getTimeSlot</span><span class="params">(Date eDate)</span></span>&#123;</span><br><span class="line">    Calendar c = Calendar.getInstance();</span><br><span class="line">    <span class="keyword">if</span>(c.getTimeInMillis()-eDate.getTime()&lt;<span class="number">60000</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;刚刚&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(c.getTimeInMillis()-eDate.getTime()&lt;<span class="number">3600000</span>)&#123;</span><br><span class="line">    <span class="keyword">long</span> minitues =  Math.abs( c.getTimeInMillis() - eDate.getTime()) / (<span class="number">60</span> * <span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">return</span> minitues+<span class="string">&quot;分钟前&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>((c.getTimeInMillis()-eDate.getTime())&lt;<span class="number">3600000</span>*<span class="number">24</span>)&#123;</span><br><span class="line">    <span class="keyword">long</span> hours =  Math.abs( c.getTimeInMillis() - eDate.getTime()) / (<span class="number">60</span>*<span class="number">60</span> * <span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">return</span> hours+<span class="string">&quot;小时前&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>((c.getTimeInMillis()-eDate.getTime())&lt;<span class="number">3600000</span>*<span class="number">24</span>*<span class="number">7</span>)&#123;</span><br><span class="line">    <span class="keyword">long</span> days =  Math.abs( c.getTimeInMillis() - eDate.getTime()) / (<span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span> * <span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">return</span> days+<span class="string">&quot;天前&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getDateFormat(eDate);</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取日期前n分钟</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getNMinutesBefore</span><span class="params">(Date date,<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        gregorianCalendar.setTime(date);</span><br><span class="line">        <span class="keyword">int</span> minute = gregorianCalendar.get(Calendar.MINUTE);</span><br><span class="line">        gregorianCalendar.set(Calendar.MINUTE, minute - n);</span><br><span class="line">        <span class="keyword">return</span> gregorianCalendar.getTime();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当年的第一天</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getCurrYearFirst</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Calendar currCal=Calendar.getInstance();  </span><br><span class="line">        <span class="keyword">int</span> currentYear = currCal.get(Calendar.YEAR);</span><br><span class="line">        <span class="keyword">return</span> getYearFirst(currentYear);</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取当年的最后一天</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getCurrYearLast</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Calendar currCal=Calendar.getInstance();  </span><br><span class="line">        <span class="keyword">int</span> currentYear = currCal.get(Calendar.YEAR);</span><br><span class="line">        <span class="keyword">return</span> getYearLast(currentYear);</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取某年第一天日期</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> year 骞翠唤</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Date</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getYearFirst</span><span class="params">(<span class="keyword">int</span> year)</span></span>&#123;</span><br><span class="line">        Calendar calendar = Calendar.getInstance();</span><br><span class="line">        calendar.clear();</span><br><span class="line">        calendar.set(Calendar.YEAR, year);</span><br><span class="line">        Date currYearFirst = calendar.getTime();</span><br><span class="line">        <span class="keyword">return</span> currYearFirst;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取某年最后一天日期</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> year 骞翠唤</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Date</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">getYearLast</span><span class="params">(<span class="keyword">int</span> year)</span></span>&#123;</span><br><span class="line">        Calendar calendar = Calendar.getInstance();</span><br><span class="line">        calendar.clear();</span><br><span class="line">        calendar.set(Calendar.YEAR, year);</span><br><span class="line">        calendar.roll(Calendar.DAY_OF_YEAR, -<span class="number">1</span>);</span><br><span class="line">        Date currYearLast = calendar.getTime();</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">return</span> currYearLast;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> TimeUtils </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
